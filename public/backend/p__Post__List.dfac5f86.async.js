(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[24],{nKVh:function(e,t,a){"use strict";a.r(t);a("IzEo");var s,o,l,r=a("bx4M"),n=(a("g9YV"),a("wCAj")),i=(a("14J3"),a("BMrR")),c=(a("jCWc"),a("kPKH")),d=(a("qVdP"),a("jsC+")),u=(a("Pwec"),a("CtXQ")),p=(a("+L6B"),a("2/Rp")),m=(a("lUTK"),a("BvKs")),f=(a("/zsF"),a("PArb")),g=(a("Awhp"),a("KrTs")),b=(a("2qtc"),a("kLXV")),h=a("2Taf"),y=a.n(h),j=a("vZ4D"),E=a.n(j),O=a("l4Ni"),M=a.n(O),k=a("ujKo"),q=a.n(k),v=a("rlhR"),w=a.n(v),S=a("MhPg"),C=a.n(S),x=(a("5NDa"),a("5rEg")),I=a("q1tI"),P=a.n(I),D=a("MuoO"),R=a("7DNP"),K=a("LLXN"),T=a("wd/R"),z=a.n(T),B=(a("nRaC"),a("5RzL")),V=(a("y8nQ"),a("Vl3Y")),N=a("jehZ"),A=a.n(N),F=(a("OaEy"),a("2fM7")),L=a("p0pE"),Y=a.n(L),J=a("+n12"),H=function(e){function t(){var e,a;y()(this,t);for(var s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];return a=M()(this,(e=q()(t)).call.apply(e,[this].concat(o))),a.state={},a.handleSubmit=function(e){return function(){var t=a.props,s=t.modal,o=t.form;o.validateFields(function(t,a){t||(s.confirm(Y()({},a,{slugData:e})),o.resetFields())})}},a.handleCancel=function(){var e=a.props,t=e.modal,s=e.form;t.cancel(),s.resetFields()},a}return C()(t,e),E()(t,[{key:"render",value:function(){var e=F["a"].Option,t=this.props.form.getFieldDecorator,a=this.props,s=a.show,o=a.data,l=a.modal,r=a.category.post,n=Object(J["i"])(r),i={labelCol:{span:4},wrapperCol:{span:18}},c=o||{},d=c.title,u=c.slug,p=c.status,m=c.post;return P.a.createElement(b["a"],{title:Object(K["formatMessage"])({id:"common.quick.edit"}),visible:s,maskClosable:!1,forceRender:"true",onOk:this.handleSubmit(u),onCancel:this.handleCancel},P.a.createElement(V["a"],{onSubmit:l.submit},o&&P.a.createElement(V["a"].Item,A()({},i,{label:Object(K["formatMessage"])({id:"post.title"})}),t("title",{initialValue:d,rules:[{required:!0,message:Object(K["formatMessage"])({id:"post.tips.fill.title"})}]})(P.a.createElement(x["a"],{placeholder:Object(K["formatMessage"])({id:"post.tips.fill.title"})}))),o&&P.a.createElement(V["a"].Item,A()({},i,{label:Object(K["formatMessage"])({id:"post.slug"})}),t("slug",{initialValue:u,rules:[{required:!0,message:Object(K["formatMessage"])({id:"post.tips.fill.slug"})}]})(P.a.createElement(x["a"],{placeholder:Object(K["formatMessage"])({id:"post.tips.fill.slug"})}))),P.a.createElement(V["a"].Item,A()({},i,{label:Object(K["formatMessage"])({id:"post.category.post"})}),t("post",{initialValue:m})(P.a.createElement(B["a"],{treeData:n,showSearch:!0,treeNodeFilterProp:"title",treeDefaultExpandAll:!0,placeholder:Object(K["formatMessage"])({id:"post.tips.fill.post"})}))),P.a.createElement(V["a"].Item,A()({},i,{label:Object(K["formatMessage"])({id:"post.status"})}),t("status",{initialValue:p||"draft",rules:[{required:!0,message:Object(K["formatMessage"])({id:"post.tips.fill.status"})}]})(P.a.createElement(F["a"],{placeholder:Object(K["formatMessage"])({id:"post.tips.fill.status"})},P.a.createElement(e,{value:"draft"},Object(K["formatMessage"])({id:"common.draft"})),P.a.createElement(e,{value:"publish"},Object(K["formatMessage"])({id:"common.publish"})),P.a.createElement(e,{value:"reject"},Object(K["formatMessage"])({id:"common.reject"})))))))}}]),t}(I["PureComponent"]),Q=V["a"].create()(H),X=x["a"].Search,Z=(s=Object(D["connect"])(function(e){var t=e.post,a=e.category,s=e.loading;return{post:t,category:a,loading:s.models.post}}),s((l=function(e){function t(e){var a;y()(this,t),a=M()(this,q()(t).call(this,e)),a.list={quickEdit:function(e){return function(){a.setState({quickEditData:{title:e.title,slug:e.slug,post:e.category.post?e.category.post._id:null,status:e.status}}),a.modal.show()}},fullEdit:function(e){return function(){var t=a.props.dispatch;t(R["routerRedux"].push("/post/slug/".concat(e)))}},fulldelete:function(e){return function(){var t=a.props.dispatch;t({type:"post/deletePost",payload:{params:{slug:e}}})}}},a.table={addNew:function(){var e=a.props.dispatch;e(R["routerRedux"].push("/post/create"))},batchEdit:function(){a.setState({quickEditStatus:!0})},batchDelete:function(){b["a"].confirm({title:Object(K["formatMessage"])({id:"post.list.delete.post"}),content:Object(K["formatMessage"])({id:"post.list.delete.post.tips"}),okText:Object(K["formatMessage"])({id:"common.confirm"}),cancelText:Object(K["formatMessage"])({id:"common.cancel"}),onOk:function(){a.deleteBatch(!1),a.setState({selectedRowKeys:[]})}})},moreOption:function(e){switch(e.key){case"edit":a.table.allEdit();break;case"delete":a.table.allDelete();break;default:break}},allEdit:function(){a.setState({quickEditStatus:!0})},allDelete:function(){b["a"].confirm({title:Object(K["formatMessage"])({id:"post.list.delete.post"}),content:Object(K["formatMessage"])({id:"post.list.delete.post.all.tips"}),okText:Object(K["formatMessage"])({id:"common.confirm"}),cancelText:Object(K["formatMessage"])({id:"common.cancel"}),onOk:function(){a.deleteBatch(!0),a.setState({selectedRowKeys:[]})}})}},a.modal={show:function(){a.setState({quickEditStatus:!0})},cancel:function(){a.setState({quickEditStatus:!1,quickEditData:null})},confirm:function(e){var t=e.slug,s=e.status,o=e.title,l=e.post,r=e.slugData,n=a.props.dispatch,i=a.state.selectedRowKeys;a.modal.cancel(),t?n({type:"post/putPostInfo",payload:{params:{slug:r},data:{status:s,title:o,slug:t,"category.post":l}},addon:a.query}):i.length>0?(n({type:"post/putPostBatch",payload:{data:{type:"batch",list:i,data:{"category.post":l,status:s}}},addon:a.query}),a.setState({selectedRowKeys:[]})):n({type:"post/putPostBatch",payload:{data:{type:"all",data:{"category.post":l,status:s}}},addon:a.query})}},a.deleteBatch=function(e){var t=a.props.dispatch,s=a.state.selectedRowKeys;t(e?{type:"post/deletePostBatch",payload:{data:{type:"all"}},addon:a.query}:{type:"post/deletePostBatch",payload:{data:{type:"batch",list:s}},addon:a.query})},a.onSearchVideo=function(e){a.query.title=e,a.query.page=1,a.queryPost()},a.onChangeTable=function(e,t,s){var o=e.current,l=e.pageSize,r=t["category.post.slug"]?t["category.post.slug"][0]:null,n=t.status?t.status[0]:null,i=null;if(s.order){var c="descend"===s.order?"-":"",d=s.field;i="".concat(c).concat(d)}a.query={size:l,page:o,sort:i,post:r,status:n},a.queryPost()},a.queryPost=function(){var e=w()(a),t=e.query,s=a.props.dispatch;s({type:"post/queryPost",payload:{query:t}});var o=a.props,l=o.location.pathname,r=o.history;r.push({pathname:l,state:a.query})};var s=e.location.state,o=void 0===s?{}:s;return a.state={selectedRowKeys:[],quickEditStatus:!1,quickEditData:null},a.query={title:o.title,size:o.size?parseInt(o.size):10,page:o.page?parseInt(o.page):1,sort:o.sort,post:o.post,status:o.status},a}return C()(t,e),E()(t,[{key:"componentDidMount",value:function(){this.queryPost()}},{key:"render",value:function(){var e=this,t=this.state,a=t.selectedRowKeys,s=t.quickEditStatus,o=t.quickEditData,l=this.props,b=l.post,h=b.list,y=b.total,j=l.category,E=l.category.post,O=l.loading,M={post:Object(J["g"])(E).map(function(e){return{text:e.slug,value:e._id}})},k={draft:{text:Object(K["formatMessage"])({id:"common.draft"}),badge:"processing",value:"draft"},publish:{text:Object(K["formatMessage"])({id:"common.publish"}),badge:"success",value:"publish"},reject:{text:Object(K["formatMessage"])({id:"common.reject"}),badge:"error",value:"reject"}},q=[{title:Object(K["formatMessage"])({id:"post.title"}),dataIndex:"title",key:"title",width:200,sorter:!0,render:function(t,a){return P.a.createElement("span",null,P.a.createElement("a",{onClick:e.list.fullEdit(a.slug)},t))}},{title:Object(K["formatMessage"])({id:"post.slug"}),dataIndex:"slug",sorter:!0},{title:Object(K["formatMessage"])({id:"post.author"}),dataIndex:"author.name",sorter:!0},{title:Object(K["formatMessage"])({id:"post.introduce"}),dataIndex:"introduce"},{title:Object(K["formatMessage"])({id:"post.play"}),dataIndex:"play",sorter:!0},{title:Object(K["formatMessage"])({id:"post.comment"}),dataIndex:"comment",sorter:!0},{title:Object(K["formatMessage"])({id:"post.like"}),dataIndex:"like",sorter:!0},{title:Object(K["formatMessage"])({id:"post.unlike"}),dataIndex:"unlike",sorter:!0},{title:Object(K["formatMessage"])({id:"post.category.post"}),dataIndex:"category.post.slug",filters:M.post,filterMultiple:!1},{title:Object(K["formatMessage"])({id:"post.status"}),dataIndex:"status",filters:Object.values(k),filterMultiple:!1,render:function(e){return P.a.createElement(g["a"],{status:k[e].badge,text:k[e].text})}},{title:Object(K["formatMessage"])({id:"post.updatedTime"}),dataIndex:"updatedAt",sorter:!0,width:120,align:"center",render:function(e){return z()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:Object(K["formatMessage"])({id:"post.option"}),key:"action",dataIndex:"slug",render:function(t,a){return P.a.createElement("span",null,P.a.createElement("a",{onClick:e.list.quickEdit(a)},Object(K["formatMessage"])({id:"post.option.quick.edit"})),P.a.createElement(f["a"],{type:"vertical"}),P.a.createElement("a",{onClick:e.list.fullEdit(t)},Object(K["formatMessage"])({id:"post.option.full.edit"})),P.a.createElement(f["a"],{type:"vertical"}),P.a.createElement("a",{onClick:e.list.fulldelete(t)},Object(K["formatMessage"])({id:"post.option.full.delete"})))}}],v=P.a.createElement(m["b"],{onClick:this.table.moreOption},P.a.createElement(m["b"].Item,{key:"edit"},Object(K["formatMessage"])({id:"post.option.batch.all.edit"})),P.a.createElement(m["b"].Item,{key:"delete"},Object(K["formatMessage"])({id:"post.option.batch.all.delete"}))),w={selectedRowKeys:a,onChange:function(t){e.setState({selectedRowKeys:t})}},S={showSizeChanger:!0,showQuickJumper:!0,total:y,defaultCurrent:this.query.page,defaultPageSize:this.query.size,showTotal:function(e){return"".concat(Object(K["formatMessage"])({id:"common.all.total"})," ").concat(e," ").concat(Object(K["formatMessage"])({id:"common.all.item"}))}};return P.a.createElement(r["a"],{className:"tableList",bordered:!1},P.a.createElement(i["a"],{className:"head"},P.a.createElement(c["a"],{span:16},P.a.createElement(p["a"],{icon:"plus",type:"primary",onClick:this.table.addNew},Object(K["formatMessage"])({id:"common.add.new"})),a.length>0&&P.a.createElement("span",null,P.a.createElement(p["a"],{onClick:this.table.batchEdit},Object(K["formatMessage"])({id:"post.option.batch.some.edit"})),P.a.createElement(p["a"],{onClick:this.table.batchDelete},Object(K["formatMessage"])({id:"post.option.batch.some.delete"}))),P.a.createElement(d["a"],{overlay:v},P.a.createElement(p["a"],null,Object(K["formatMessage"])({id:"common.more.option"})," ",P.a.createElement(u["a"],{type:"down"})))),P.a.createElement(c["a"],{span:8},P.a.createElement(X,{placeholder:Object(K["formatMessage"])({id:"post.search"}),onSearch:this.onSearchVideo,enterButton:!0}))),P.a.createElement(i["a"],null,P.a.createElement(n["a"],{className:"longTable",loading:O,rowKey:"slug",rowSelection:w,columns:q,onChange:this.onChangeTable,dataSource:h,pagination:S})),P.a.createElement(Q,{show:s,data:o,category:j,modal:this.modal}))}}]),t}(I["Component"]),o=l))||o);t["default"]=Z}}]);
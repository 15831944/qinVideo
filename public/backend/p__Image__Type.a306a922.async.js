(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[20],{"Yzj/":function(e,t,a){"use strict";a.r(t);a("g9YV");var n,i,o,r=a("wCAj"),c=(a("14J3"),a("BMrR")),s=(a("jCWc"),a("kPKH")),m=(a("DZo9"),a("8z0m")),l=a("jehZ"),d=a.n(l),g=(a("+L6B"),a("2/Rp")),p=a("p0pE"),h=a.n(p),u=(a("5NDa"),a("5rEg")),f=(a("2qtc"),a("kLXV")),y=a("2Taf"),w=a.n(y),b=a("vZ4D"),v=a.n(b),M=a("l4Ni"),j=a.n(M),k=a("ujKo"),O=a.n(k),x=a("MhPg"),E=a.n(x),S=a("q1tI"),I=a.n(S),L=a("MuoO"),C=a("LLXN"),R=a("wd/R"),D=a.n(R),z=a("Dlz4"),K=(n=Object(L["connect"])(function(e){var t=e.image,a=e.loading;return{image:t,loading:a.models.image}}),n((o=function(e){function t(){var e,a;w()(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return a=j()(this,(e=O()(t)).call.apply(e,[this].concat(i))),a.state={selectedRowKeys:[],imgView:!1,imgUrl:"",iconLoading:!1},a.imgView={show:function(e){return function(){a.setState({imgView:!0,imgUrl:e})}},hide:function(){a.setState({imgView:!1,imgUrl:null})}},a.initData=function(e){var t=a.props.dispatch;t({type:"image/queryImageList",payload:{params:{type:e}}})},a.removeImage=function(e){return function(){var t=[e];a.deleteBatch(t)}},a.removeImageList=function(){var e=a.state.selectedRowKeys;f["a"].confirm({title:Object(C["formatMessage"])({id:"image.delete"}),content:Object(C["formatMessage"])({id:"image.delete.batch.tips"}),okText:Object(C["formatMessage"])({id:"common.confirm"}),cancelText:Object(C["formatMessage"])({id:"common.cancel"}),onOk:function(){a.deleteBatch(e),a.setState({selectedRowKeys:[]})}})},a.deleteBatch=function(e){var t=a.props,n=t.dispatch,i=t.match.params.type;n({type:"image/deleteImage",payload:{data:{list:e}},addon:{type:i}})},a.onSearchImage=function(e){a.setState({name:e})},a.handleChange=function(e){if("uploading"!==e.file.status){if("done"===e.file.status){a.setState({iconLoading:!1});var t=a.props.match.params.type;a.initData(t)}}else a.setState({iconLoading:!0})},a}return E()(t,e),v()(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params.type;this.initData(e)}},{key:"componentWillReceiveProps",value:function(e){var t=e.match.params.type,a=this.props.match.params.type;t!==a&&this.initData(t)}},{key:"render",value:function(){var e=this,t=u["a"].Search,a=this.props,n=a.loading,i=a.image,o=a.match.params.type,l=this.state,p=l.selectedRowKeys,y=l.imgUrl,w=l.imgView,b=l.name,v=l.iconLoading,M=i[o].map(function(e){var t=e.name,a=t.split("/")[3]?t.split("/")[3].split(".")[0]:null,n=t.split("/")[3]?t.split("/")[3].split(".")[1]:null;return h()({},e,{cover:e.name,name:a,kind:n})}),j=M.filter(function(e){return new RegExp(b).test(e.name)}),k=[{title:Object(C["formatMessage"])({id:"image.cover"}),dataIndex:"cover",key:"cover",render:function(t){return I.a.createElement("img",{alt:"avatar",src:t,style:{height:"60px",borderRadius:"3px",boxShadow:"0 0 10px 20px rgba(0,0,0,0.03)"},onClick:e.imgView.show(t)})}},{title:Object(C["formatMessage"])({id:"image.name"}),dataIndex:"name",key:"name"},{title:Object(C["formatMessage"])({id:"image.size"}),dataIndex:"size",key:"size",align:"center",render:function(e){return e<1048576?Math.floor(e/1024)+Object(C["formatMessage"])({id:"image.size.kb"}):(e/1024/1024).toFixed(2)+Object(C["formatMessage"])({id:"image.size.mb"})}},{title:Object(C["formatMessage"])({id:"image.kind"}),dataIndex:"kind",key:"kind",align:"center"},{title:Object(C["formatMessage"])({id:"image.created"}),dataIndex:"birthtime",key:"birthtime",align:"center",render:function(e){return D()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:Object(C["formatMessage"])({id:"image.option"}),key:"action",dataIndex:"cover",align:"center",render:function(t){return I.a.createElement("a",{onClick:e.removeImage(t)},Object(C["formatMessage"])({id:"image.delete"}))}}],O={selectedRowKeys:p,onChange:function(t){e.setState({selectedRowKeys:t})}},x={showSizeChanger:!0,showQuickJumper:!0,pageSizeOptions:["5","10","15","20","50","100","200","500"],total:j.length||0,showTotal:function(e){return"".concat(Object(C["formatMessage"])({id:"common.all.total"})," ").concat(e," ").concat(Object(C["formatMessage"])({id:"common.all.item"}))}};return I.a.createElement("div",{className:"tableList"},I.a.createElement(c["a"],{className:"head"},I.a.createElement(s["a"],{span:16,style:{height:"30px"}},I.a.createElement(m["a"],d()({name:"file",showUploadList:!1,onChange:this.handleChange,data:{type:o}},z["a"]),I.a.createElement(g["a"],{icon:"plus",type:"primary",loading:v},Object(C["formatMessage"])({id:"image.upload"}))),p.length>0&&I.a.createElement(g["a"],{onClick:this.removeImageList},Object(C["formatMessage"])({id:"common.delete.batch"}))),I.a.createElement(s["a"],{span:8},I.a.createElement(t,{placeholder:Object(C["formatMessage"])({id:"image.search"}),onSearch:this.onSearchImage,enterButton:!0}))),I.a.createElement(r["a"],{loading:n,columns:k,rowSelection:O,dataSource:j,rowKey:"cover",pagination:x}),I.a.createElement(f["a"],{visible:w,footer:null,onCancel:this.imgView.hide,centered:!0,width:"70vw",style:{textAlign:"center"}},I.a.createElement("img",{alt:Object(C["formatMessage"])({id:"common.image"}),style:{maxWidth:"100%",maxHeight:"60vh"},src:y})))}}]),t}(S["Component"]),i=o))||i);t["default"]=K}}]);
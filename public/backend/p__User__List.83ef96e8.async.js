(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[37],{CNVm:function(e,t,a){"use strict";a.r(t);a("IzEo");var r,n,s,i=a("bx4M"),l=(a("g9YV"),a("wCAj")),o=(a("14J3"),a("BMrR")),c=(a("jCWc"),a("kPKH")),d=(a("+L6B"),a("2/Rp")),u=(a("/zsF"),a("PArb")),m=(a("Awhp"),a("KrTs")),f=(a("+BJd"),a("mr32")),p=(a("Telt"),a("Tckk")),g=(a("2qtc"),a("kLXV")),h=a("p0pE"),b=a.n(h),y=a("2Taf"),O=a.n(y),M=a("vZ4D"),v=a.n(M),j=a("l4Ni"),E=a.n(j),w=a("ujKo"),x=a.n(w),k=a("rlhR"),C=a.n(k),I=a("MhPg"),R=a.n(I),q=(a("5NDa"),a("5rEg")),S=a("q1tI"),D=a.n(S),K=a("MuoO"),A=a("7DNP"),z=a("LLXN"),T=a("wd/R"),V=a.n(T),B=(a("giR+"),a("fyUT")),L=(a("y8nQ"),a("Vl3Y")),N=a("jehZ"),P=a.n(N),Y=(a("OaEy"),a("2fM7")),F=a("zX7x"),J=Y["a"].Option,U=function(e){function t(){var e,a;O()(this,t);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return a=E()(this,(e=x()(t)).call.apply(e,[this].concat(n))),a.state={show:!1,data:{}},a.handleSubmit=function(){var e=a.state.data,t=a.props,r=t.form,n=t.submit;r.validateFields(function(t,a){t||n(b()({},e,a))})},a.handleCancel=function(){a.setState({show:!1,data:{}})},a.modalShow=function(e){var t=e.type,r=e.data;a.setState({show:!0,data:b()({type:t},r)})},a}return R()(t,e),v()(t,[{key:"render",value:function(){var e=this.state,t=e.show,a=e.data,r=this.props.form.getFieldDecorator,n={labelCol:{span:4},wrapperCol:{span:18}};return D.a.createElement(g["a"],{title:Object(z["formatMessage"])({id:"common.quick.edit"}),visible:t,maskClosable:!1,forceRender:"true",onOk:this.handleSubmit,onCancel:this.handleCancel,destroyOnClose:!0},D.a.createElement(L["a"],null,a.id&&D.a.createElement(L["a"].Item,P()({},n,{label:Object(z["formatMessage"])({id:"user.avatar"})}),r("avatar",{initialValue:a.id?a.avatar:null})(D.a.createElement(F["a"],{width:120,height:120}))),D.a.createElement(L["a"].Item,P()({},n,{label:Object(z["formatMessage"])({id:"user.score"})}),r("score",{initialValue:a.id?a.score:void 0})(D.a.createElement(B["a"],null))),D.a.createElement(L["a"].Item,P()({},n,{label:Object(z["formatMessage"])({id:"user.level"})}),r("level",{initialValue:a.id?a.level:void 0})(D.a.createElement(B["a"],null))),a.id&&D.a.createElement(L["a"].Item,P()({},n,{label:Object(z["formatMessage"])({id:"user.name"})}),r("name",{initialValue:a.id?a.name:null,rules:[{required:!0,message:Object(z["formatMessage"])({id:"user.tips.fill.name"})}]})(D.a.createElement(q["a"],{placeholder:Object(z["formatMessage"])({id:"user.tips.fill.name"})}))),a.id&&D.a.createElement(L["a"].Item,P()({},n,{label:Object(z["formatMessage"])({id:"user.email"})}),r("email",{initialValue:a.id?a.email:null,rules:[{required:!0,message:Object(z["formatMessage"])({id:"user.tips.fill.email"})}]})(D.a.createElement(q["a"],{placeholder:Object(z["formatMessage"])({id:"user.tips.fill.email"})}))),D.a.createElement(L["a"].Item,P()({},n,{label:Object(z["formatMessage"])({id:"animate.status"})}),r("status",{initialValue:a.status||void 0})(D.a.createElement(Y["a"],{placeholder:Object(z["formatMessage"])({id:"animate.tips.fill.status"})},D.a.createElement(J,{value:"draft"},Object(z["formatMessage"])({id:"user.inactive"})),D.a.createElement(J,{value:"publish"},Object(z["formatMessage"])({id:"user.active"})),D.a.createElement(J,{value:"reject"},Object(z["formatMessage"])({id:"user.unused"})))))))}}]),t}(S["PureComponent"]),H=L["a"].create()(U),X=a("ZeOv"),Z=q["a"].Search,_=(r=Object(K["connect"])(function(e){var t=e.user,a=e.loading;return{user:t,loading:a.models.user}}),r((s=function(e){function t(e){var a;O()(this,t),a=E()(this,x()(t).call(this,e)),a.editRef=D.a.createRef(null),a.submit=function(e){var t=a.props.dispatch,r=a.state.selectedRowKeys,n=e.type,s=n?"all"===n?[]:r:[e.id];t({type:"user/putUserBatch",payload:{data:b()({},e,{ids:s})}}).then(function(e){e&&a.editRef.handleCancel(),a.initData(),a.setState({selectedRowKeys:[]})})},a.editOne=function(e){var t={name:e.name,email:e.email,status:e.status,level:e.level,id:e._id,score:e.score};a.edit({data:t})},a.editMany=function(){a.edit({type:"many"})},a.editAll=function(){a.edit({type:"all"})},a.edit=function(e){var t=e.type,r=e.data;a.editRef.modalShow({type:t,data:r})},a.deleteMany=function(){var e=a.state.selectedRowKeys;a.destroy(e)},a.deleteAll=function(){a.destroy([])},a.deleteOne=function(e){return function(){a.destroy([e])}},a.destroy=function(e){var t=a.props.dispatch;g["a"].confirm({title:Object(z["formatMessage"])({id:"user.list.delete.user"}),content:Object(z["formatMessage"])({id:"common.delete.tips"}),okText:Object(z["formatMessage"])({id:"common.confirm"}),cancelText:Object(z["formatMessage"])({id:"common.cancel"}),onOk:function(){return t({type:"user/deleteUserBatch",payload:{data:{ids:e}}}).then(function(e){e&&(a.initData(),a.setState({selectedRowKeys:[]}))})}})},a.onSearch=function(e){a.query.title=e,a.query.page=1,a.initData()},a.onChangeTable=function(e,t,r){var n,s,i=e.current,l=e.pageSize,o=t.status?t.status[0]:null;r.order&&(n="descend"===r.order?-1:1,s=r.field),a.query=b()({},a.query,{size:l,page:i,sortBy:s,sortOrder:n,status:o}),a.initData()},a.initData=function(){var e=C()(a),t=e.query,r=a.props.dispatch;r({type:"user/queryUser",payload:{query:t}});var n=a.props,s=n.location.pathname,i=n.history;i.push({pathname:s,state:a.query})};var r=e.location.state,n=void 0===r?{}:r;return a.state={selectedRowKeys:[]},a.query={title:n.title,size:n.size?n.size:10,page:n.page?n.page:1,sortBy:n.sortBy,sortOrder:n.sortOrder,status:n.status},a}return R()(t,e),v()(t,[{key:"componentDidMount",value:function(){this.initData()}},{key:"render",value:function(){var e=this,t=this.state.selectedRowKeys,a=this.props,r=a.user,n=r.list,s=r.total,g=a.loading,h=[{title:Object(z["formatMessage"])({id:"user.avatar"}),dataIndex:"avatar",align:"center",render:function(e){return D.a.createElement(p["a"],{size:64,shape:"square",icon:"user",src:e})}},{title:Object(z["formatMessage"])({id:"user.name"}),dataIndex:"name",key:"name",sorter:!0,align:"center",render:function(e,t){return D.a.createElement(A["Link"],{to:"/user/slug/".concat(t.id)},e)}},{title:Object(z["formatMessage"])({id:"user.email"}),dataIndex:"email",sorter:!0,align:"center"},{title:Object(z["formatMessage"])({id:"user.level"}),dataIndex:"level",sorter:!0,align:"center",render:function(e){var t;return t=0===e?null:e<11?"#2db7f5":e<21?"#87d068":e<31?"#108ee9":e<41?"#33cc33":e<51?"#9966ff":e<61?"#993399":e<71?"#ff9966":e<81?"#669999":e<91?"#00cc44":e<100?"#9900cc":"#f50",D.a.createElement(f["a"],{color:t},e)}},{title:Object(z["formatMessage"])({id:"user.score"}),dataIndex:"score",sorter:!0,align:"center"},{title:Object(z["formatMessage"])({id:"user.money"}),dataIndex:"money",sorter:!0,align:"center"},{title:Object(z["formatMessage"])({id:"user.expired"}),dataIndex:"expired",sorter:!0,align:"center",render:function(e){return"".concat((e/3600/24).toFixed(2),"\u5929")}},{title:Object(z["formatMessage"])({id:"user.animate"}),dataIndex:"countAnimate",sorter:!0,align:"center"},{title:Object(z["formatMessage"])({id:"user.comic"}),dataIndex:"countComic",sorter:!0,align:"center"},{title:Object(z["formatMessage"])({id:"user.post"}),dataIndex:"countPost",sorter:!0,align:"center"},{title:Object(z["formatMessage"])({id:"user.comment"}),dataIndex:"countComment",sorter:!0,align:"center"},{title:Object(z["formatMessage"])({id:"user.status"}),dataIndex:"status",filters:Object.values(X["i"]),filterMultiple:!1,render:function(e){return D.a.createElement(m["a"],{status:X["i"][e].badge,text:X["i"][e].text})},align:"center"},{title:Object(z["formatMessage"])({id:"user.createdAt"}),dataIndex:"createdAt",sorter:!0,width:120,align:"center",render:function(e){return V()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:Object(z["formatMessage"])({id:"user.option"}),key:"action",dataIndex:"id",align:"center",render:function(t,a){return D.a.createElement("span",null,D.a.createElement("a",{onClick:function(){return e.editOne(a)}},Object(z["formatMessage"])({id:"user.option.quick.edit"})),D.a.createElement(u["a"],{type:"vertical"}),D.a.createElement(A["Link"],{to:"/user/slug/".concat(t)},Object(z["formatMessage"])({id:"user.option.full.edit"})),D.a.createElement(u["a"],{type:"vertical"}),D.a.createElement("a",{onClick:e.deleteOne(t)},Object(z["formatMessage"])({id:"user.option.full.delete"})))}}],b={selectedRowKeys:t,onChange:function(t){e.setState({selectedRowKeys:t})}},y=Object(X["e"])(this.query.page,this.query.size,s);return D.a.createElement(i["a"],{className:"tableList",bordered:!1},D.a.createElement(o["a"],{className:"head"},D.a.createElement(c["a"],{span:16},D.a.createElement(A["Link"],{to:"/user/create"},D.a.createElement(d["a"],{icon:"plus",type:"primary"},Object(z["formatMessage"])({id:"common.add.new"}))),t.length>0&&D.a.createElement(X["b"],{edit:this.editMany,delete:this.deleteMany}),D.a.createElement(X["a"],{edit:this.editAll,delete:this.deleteAll})),D.a.createElement(c["a"],{span:8},D.a.createElement(Z,{placeholder:Object(z["formatMessage"])({id:"user.search"}),onSearch:this.onSearch,enterButton:!0}))),D.a.createElement(o["a"],null,D.a.createElement(l["a"],{className:"longTable",loading:g,rowKey:"_id",rowSelection:b,columns:h,onChange:this.onChangeTable,dataSource:n,pagination:y})),D.a.createElement(H,{submit:this.submit,wrappedComponentRef:function(t){return e.editRef=t}}))}}]),t}(S["Component"]),n=s))||n);t["default"]=_}}]);
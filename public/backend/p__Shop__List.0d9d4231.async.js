(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[32],{GHaO:function(e,t,a){"use strict";a.r(t);a("IzEo");var s,r,i,o=a("bx4M"),n=(a("g9YV"),a("wCAj")),l=(a("14J3"),a("BMrR")),d=(a("jCWc"),a("kPKH")),c=(a("+L6B"),a("2/Rp")),p=(a("/zsF"),a("PArb")),m=(a("Awhp"),a("KrTs")),u=(a("Telt"),a("Tckk")),h=(a("2qtc"),a("kLXV")),f=a("p0pE"),b=a.n(f),g=a("2Taf"),y=a.n(g),O=a("vZ4D"),M=a.n(O),j=a("l4Ni"),E=a.n(j),v=a("ujKo"),w=a.n(v),x=a("rlhR"),S=a.n(x),R=a("MhPg"),C=a.n(R),I=(a("5NDa"),a("5rEg")),k=a("q1tI"),q=a.n(k),V=a("MuoO"),D=a("LLXN"),L=a("wd/R"),z=a.n(L),A=(a("giR+"),a("fyUT")),K=(a("y8nQ"),a("Vl3Y")),T=a("jehZ"),B=a.n(T),N=(a("OaEy"),a("2fM7")),Y=a("zX7x"),F=I["a"].TextArea,H=N["a"].Option,P=function(e){function t(){var e,a;y()(this,t);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return a=E()(this,(e=w()(t)).call.apply(e,[this].concat(r))),a.state={show:!1,data:{}},a.handleSubmit=function(){var e=a.state.data,t=a.props,s=t.form,r=t.submit;s.validateFields(function(t,a){t||r(b()({},e,a))})},a.handleCancel=function(){var e=a.props.cancel;a.setState({show:!1,data:{}}),e&&e()},a.modalShow=function(e){var t=e.type,s=e.data;a.setState({show:!0,data:b()({type:t},s)})},a}return C()(t,e),M()(t,[{key:"render",value:function(){var e=this.state,t=e.show,a=e.data,s=this.props.form.getFieldDecorator,r={labelCol:{span:4},wrapperCol:{span:18}},i="many"!==a.type&&"all"!==a.type;return q.a.createElement(h["a"],{title:Object(D["formatMessage"])({id:"common.edit"}),visible:t,maskClosable:!1,forceRender:"true",onOk:this.handleSubmit,onCancel:this.handleCancel,destroyOnClose:!0},q.a.createElement(K["a"],null,q.a.createElement(K["a"].Item,B()({},r,{label:Object(D["formatMessage"])({id:"shop.cover"})}),s("cover",{initialValue:a.cover})(q.a.createElement(Y["a"],{width:354,height:120}))),i&&q.a.createElement(K["a"].Item,B()({},r,{label:Object(D["formatMessage"])({id:"shop.title"})}),s("title",{initialValue:a.title,rules:[{required:!0,message:Object(D["formatMessage"])({id:"shop.title"})}]})(q.a.createElement(I["a"],{placeholder:Object(D["formatMessage"])({id:"shop.title"})}))),q.a.createElement(K["a"].Item,B()({},r,{label:Object(D["formatMessage"])({id:"shop.status"})}),s("status",{initialValue:a.status||"draft",rules:[{required:!0,message:Object(D["formatMessage"])({id:"shop.status"})}]})(q.a.createElement(N["a"],{placeholder:Object(D["formatMessage"])({id:"shop.status.extra"})},q.a.createElement(H,{value:"draft"},Object(D["formatMessage"])({id:"shop.draft"})),q.a.createElement(H,{value:"publish"},Object(D["formatMessage"])({id:"shop.publish"})),q.a.createElement(H,{value:"reject"},Object(D["formatMessage"])({id:"shop.reject"}))))),i&&q.a.createElement(K["a"].Item,B()({},r,{label:Object(D["formatMessage"])({id:"shop.introduce"}),extra:Object(D["formatMessage"])({id:"shop.introduce.extra"})}),s("introduce",{initialValue:a.introduce})(q.a.createElement(F,{placeholder:Object(D["formatMessage"])({id:"shop.introduce.tips"}),autosize:{minRows:3,maxRows:6}}))),i?q.a.createElement(K["a"].Item,B()({},r,{label:Object(D["formatMessage"])({id:"shop.price"})}),s("price",{initialValue:a.price,rules:[{required:!0,message:Object(D["formatMessage"])({id:"shop.price.tips"})}]})(q.a.createElement(A["a"],{style:{width:"100%"},placeholder:Object(D["formatMessage"])({id:"common.select"})}))):q.a.createElement(K["a"].Item,B()({},r,{label:Object(D["formatMessage"])({id:"shop.price"}),extra:Object(D["formatMessage"])({id:"shop.empty.tips"})}),s("price",{initialValue:a.price})(q.a.createElement(A["a"],{style:{width:"100%"},placeholder:Object(D["formatMessage"])({id:"common.select"})}))),q.a.createElement(K["a"].Item,B()({},r,{label:Object(D["formatMessage"])({id:"shop.addLevel"}),extra:Object(D["formatMessage"])({id:"shop.addLevel.extra"})}),s("upLevel",{initialValue:a.upLevel})(q.a.createElement(A["a"],{style:{width:"100%"},placeholder:Object(D["formatMessage"])({id:"common.select"})}))),q.a.createElement(K["a"].Item,B()({},r,{label:Object(D["formatMessage"])({id:"shop.addScore"})}),s("addScore",{initialValue:a.addScore})(q.a.createElement(A["a"],{style:{width:"100%"},placeholder:Object(D["formatMessage"])({id:"common.select"})}))),q.a.createElement(K["a"].Item,B()({},r,{label:Object(D["formatMessage"])({id:"shop.addExpired"}),extra:Object(D["formatMessage"])({id:"shop.addExpired.extra"})}),s("addExpired",{initialValue:a.addExpired})(q.a.createElement(A["a"],{style:{width:"100%"},placeholder:Object(D["formatMessage"])({id:"common.select"})})))))}}]),t}(k["PureComponent"]),J=K["a"].create()(P),X=a("ZeOv"),Z=I["a"].Search,_=(s=Object(V["connect"])(function(e){var t=e.shop,a=e.loading;return{shop:t,loading:a.models.shop}}),s((i=function(e){function t(e){var a;y()(this,t),a=E()(this,w()(t).call(this,e)),a.editRef=q.a.createRef(null),a.submit=function(e){var t=a.props.dispatch,s=a.state.selectedRowKeys,r=e.type;if("many"===r||"all"===r||"one"===r){var i="one"===r?[e.id]:"all"===r?[]:s;t({type:"shop/putShopBatch",payload:{data:b()({},e,{ids:i}),remove:"all"===r||"many"===r}}).then(function(e){e&&a.editRef.handleCancel(),a.initData()})}else t({type:"shop/postShop",payload:{data:b()({},e)}}).then(function(e){e&&a.editRef.handleCancel(),a.initData()})},a.editNew=function(){a.edit({type:"new",data:{}})},a.editOne=function(e){var t={title:e.title,status:e.status,price:e.price,upLevel:e.upLevel,addScore:e.addScore,addExpired:e.addExpired,introduce:e.introduce,cover:e.cover,id:e._id};a.edit({type:"one",data:t})},a.editMany=function(){a.edit({type:"many"})},a.editAll=function(){a.edit({type:"all"})},a.edit=function(e){var t=e.type,s=e.data;a.editRef.modalShow({type:t,data:s})},a.deleteMany=function(){var e=a.state.selectedRowKeys;a.destroy(e)},a.deleteAll=function(){a.destroy([])},a.deleteOne=function(e){return function(){a.destroy([e])}},a.destroy=function(e){var t=a.props.dispatch;h["a"].confirm({title:Object(D["formatMessage"])({id:"shop.list.delete.shop"}),content:Object(D["formatMessage"])({id:"common.delete.tips"}),okText:Object(D["formatMessage"])({id:"common.confirm"}),cancelText:Object(D["formatMessage"])({id:"common.cancel"}),onOk:function(){return t({type:"shop/deleteShopBatch",payload:{data:{ids:e}}}).then(function(e){e&&(a.initData(),a.setState({selectedRowKeys:[]}))})}})},a.onSearchVideo=function(e){a.query.title=e,a.query.page=1,a.initData()},a.onChangeTable=function(e,t,s){var r,i,o=e.current,n=e.pageSize,l=t.status?t.status[0]:null;s.order&&(r="descend"===s.order?-1:1,i=s.field),a.query=b()({},a.query,{size:n,page:o,sortBy:i,sortOrder:r,status:l}),a.initData()},a.initData=function(){var e=S()(a),t=e.query,s=a.props.dispatch;s({type:"shop/queryShop",payload:{query:t}});var r=a.props,i=r.location.pathname,o=r.history;o.push({pathname:i,state:a.query})};var s=e.location.state,r=void 0===s?{}:s;return a.state={selectedRowKeys:[]},a.query={title:r.title,size:r.size?r.size:10,page:r.page?r.page:1,sortBy:r.sortBy,sortOrder:r.sortOrder,status:r.status},a}return C()(t,e),M()(t,[{key:"componentDidMount",value:function(){this.initData()}},{key:"render",value:function(){var e=this,t=this.state.selectedRowKeys,a=this.props,s=a.shop.shop,r=s.list,i=s.total,h=a.loading,f=[{title:Object(D["formatMessage"])({id:"shop.title"}),dataIndex:"title",key:"title",width:200,sorter:!0},{title:Object(D["formatMessage"])({id:"shop.price"}),dataIndex:"price",sorter:!0,width:100},{title:Object(D["formatMessage"])({id:"shop.addLevel"}),dataIndex:"upLevel",sorter:!0,width:150},{title:Object(D["formatMessage"])({id:"shop.addScore"}),dataIndex:"addScore",sorter:!0,width:150},{title:Object(D["formatMessage"])({id:"shop.addExpired"}),dataIndex:"addExpired",sorter:!0,render:function(e){return"".concat(((e||0)/3600/24).toFixed(2),"\u5929")},width:200},{title:Object(D["formatMessage"])({id:"shop.introduce"}),dataIndex:"introduce"},{title:Object(D["formatMessage"])({id:"shop.cover"}),dataIndex:"cover",render:function(e){return q.a.createElement(u["a"],{src:e,size:60,shape:"square"})}},{title:Object(D["formatMessage"])({id:"shop.status"}),dataIndex:"status",filters:Object.values(X["f"]),filterMultiple:!1,width:100,render:function(e){return q.a.createElement(m["a"],{status:X["f"][e].badge,text:X["f"][e].text})}},{title:Object(D["formatMessage"])({id:"shop.createdAt"}),dataIndex:"createdAt",sorter:!0,width:120,align:"center",render:function(e){return z()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:Object(D["formatMessage"])({id:"shop.option"}),key:"action",dataIndex:"_id",align:"center",render:function(t,a){return q.a.createElement("span",null,q.a.createElement("a",{onClick:function(){return e.editOne(a)}},Object(D["formatMessage"])({id:"animate.option.full.edit"})),q.a.createElement(p["a"],{type:"vertical"}),q.a.createElement("a",{onClick:e.deleteOne(t)},Object(D["formatMessage"])({id:"animate.option.full.delete"})))}}],b={selectedRowKeys:t,onChange:function(t){e.setState({selectedRowKeys:t})}},g=Object(X["h"])(this.query.page,this.query.size,i);return q.a.createElement(o["a"],{className:"tableList",bordered:!1},q.a.createElement(l["a"],{className:"head"},q.a.createElement(d["a"],{span:16},q.a.createElement(c["a"],{icon:"plus",type:"primary",onClick:this.editNew},Object(D["formatMessage"])({id:"common.add.new"})),t.length>0&&q.a.createElement(X["b"],{edit:this.editMany,delete:this.deleteMany}),q.a.createElement(X["a"],{edit:this.editAll,delete:this.deleteAll})),q.a.createElement(d["a"],{span:8},q.a.createElement(Z,{placeholder:Object(D["formatMessage"])({id:"shop.search"}),onSearch:this.onSearchVideo,enterButton:!0}))),q.a.createElement(l["a"],null,q.a.createElement(n["a"],{className:"longTable",loading:h,rowKey:"_id",rowSelection:b,columns:f,onChange:this.onChangeTable,dataSource:r,pagination:g})),q.a.createElement(J,{submit:this.submit,wrappedComponentRef:function(t){return e.editRef=t}}))}}]),t}(k["Component"]),r=i))||r);t["default"]=_}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{Bb3K:function(e,t,a){"use strict";a.r(t);a("IzEo");var c,o,i,l=a("bx4M"),s=(a("g9YV"),a("wCAj")),n=(a("14J3"),a("BMrR")),r=(a("jCWc"),a("kPKH")),m=(a("qVdP"),a("jsC+")),d=(a("Pwec"),a("CtXQ")),u=(a("+L6B"),a("2/Rp")),p=(a("lUTK"),a("BvKs")),f=(a("/zsF"),a("PArb")),g=(a("Awhp"),a("KrTs")),b=(a("2qtc"),a("kLXV")),h=a("2Taf"),y=a.n(h),j=a("vZ4D"),O=a.n(j),E=a("l4Ni"),M=a.n(E),k=a("ujKo"),v=a.n(k),C=a("rlhR"),q=a.n(C),w=a("MhPg"),x=a.n(w),S=(a("5NDa"),a("5rEg")),I=a("q1tI"),D=a.n(I),R=a("MuoO"),K=a("7DNP"),B=a("LLXN"),T=a("wd/R"),z=a.n(T),N=(a("nRaC"),a("5RzL")),P=(a("y8nQ"),a("Vl3Y")),V=a("jehZ"),A=a.n(V),F=(a("OaEy"),a("2fM7")),L=a("p0pE"),U=a.n(L),Y=a("+n12"),J=function(e){function t(){var e,a;y()(this,t);for(var c=arguments.length,o=new Array(c),i=0;i<c;i++)o[i]=arguments[i];return a=M()(this,(e=v()(t)).call.apply(e,[this].concat(o))),a.state={},a.handleSubmit=function(e){return function(){var t=a.props,c=t.modal,o=t.form;o.validateFields(function(t,a){t||(c.confirm(U()({},a,{slugData:e})),o.resetFields())})}},a.handleCancel=function(){var e=a.props,t=e.modal,c=e.form;t.cancel(),c.resetFields()},a}return x()(t,e),O()(t,[{key:"render",value:function(){var e=F["a"].Option,t=this.props.form.getFieldDecorator,a=this.props,c=a.show,o=a.data,i=a.modal,l=a.category.comic,s=Object(Y["i"])(l),n={labelCol:{span:4},wrapperCol:{span:18}},r=o||{},m=r.title,d=r.slug,u=r.status,p=r.comic;return D.a.createElement(b["a"],{title:Object(B["formatMessage"])({id:"common.quick.edit"}),visible:c,maskClosable:!1,forceRender:"true",onOk:this.handleSubmit(d),onCancel:this.handleCancel},D.a.createElement(P["a"],{onSubmit:i.submit},o&&D.a.createElement(P["a"].Item,A()({},n,{label:Object(B["formatMessage"])({id:"comic.title"})}),t("title",{initialValue:m,rules:[{required:!0,message:Object(B["formatMessage"])({id:"comic.tips.fill.title"})}]})(D.a.createElement(S["a"],{placeholder:Object(B["formatMessage"])({id:"comic.tips.fill.title"})}))),o&&D.a.createElement(P["a"].Item,A()({},n,{label:Object(B["formatMessage"])({id:"comic.slug"})}),t("slug",{initialValue:d,rules:[{required:!0,message:Object(B["formatMessage"])({id:"comic.tips.fill.slug"})}]})(D.a.createElement(S["a"],{placeholder:Object(B["formatMessage"])({id:"comic.tips.fill.slug"})}))),D.a.createElement(P["a"].Item,A()({},n,{label:Object(B["formatMessage"])({id:"comic.category.comic"})}),t("comic",{initialValue:p})(D.a.createElement(N["a"],{treeData:s,showSearch:!0,treeNodeFilterProp:"title",treeDefaultExpandAll:!0,placeholder:Object(B["formatMessage"])({id:"comic.tips.fill.comic"})}))),D.a.createElement(P["a"].Item,A()({},n,{label:Object(B["formatMessage"])({id:"comic.status"})}),t("status",{initialValue:u||"draft",rules:[{required:!0,message:Object(B["formatMessage"])({id:"comic.tips.fill.status"})}]})(D.a.createElement(F["a"],{placeholder:Object(B["formatMessage"])({id:"comic.tips.fill.status"})},D.a.createElement(e,{value:"draft"},Object(B["formatMessage"])({id:"common.draft"})),D.a.createElement(e,{value:"publish"},Object(B["formatMessage"])({id:"common.publish"})),D.a.createElement(e,{value:"reject"},Object(B["formatMessage"])({id:"common.reject"})))))))}}]),t}(I["PureComponent"]),H=P["a"].create()(J),Q=S["a"].Search,X=(c=Object(R["connect"])(function(e){var t=e.comic,a=e.category,c=e.loading;return{comic:t,category:a,loading:c.models.comic}}),c((i=function(e){function t(e){var a;y()(this,t),a=M()(this,v()(t).call(this,e)),a.list={quickEdit:function(e){return function(){a.setState({quickEditData:{title:e.title,slug:e.slug,comic:e.category.comic?e.category.comic._id:null,status:e.status}}),a.modal.show()}},fullEdit:function(e){return function(){var t=a.props.dispatch;t(K["routerRedux"].push("/comic/slug/".concat(e)))}},fulldelete:function(e){return function(){var t=a.props.dispatch;t({type:"comic/deleteComic",payload:{params:{slug:e}}})}}},a.table={addNew:function(){var e=a.props.dispatch;e(K["routerRedux"].push("/comic/create"))},batchEdit:function(){a.setState({quickEditStatus:!0})},batchDelete:function(){b["a"].confirm({title:Object(B["formatMessage"])({id:"comic.list.delete.comic"}),content:Object(B["formatMessage"])({id:"comic.list.delete.comic.tips"}),okText:Object(B["formatMessage"])({id:"common.confirm"}),cancelText:Object(B["formatMessage"])({id:"common.cancel"}),onOk:function(){a.deleteBatch(!1),a.setState({selectedRowKeys:[]})}})},moreOption:function(e){switch(e.key){case"edit":a.table.allEdit();break;case"delete":a.table.allDelete();break;default:break}},allEdit:function(){a.setState({quickEditStatus:!0})},allDelete:function(){b["a"].confirm({title:Object(B["formatMessage"])({id:"comic.list.delete.comic"}),content:Object(B["formatMessage"])({id:"comic.list.delete.comic.all.tips"}),okText:Object(B["formatMessage"])({id:"common.confirm"}),cancelText:Object(B["formatMessage"])({id:"common.cancel"}),onOk:function(){a.deleteBatch(!0),a.setState({selectedRowKeys:[]})}})}},a.modal={show:function(){a.setState({quickEditStatus:!0})},cancel:function(){a.setState({quickEditStatus:!1,quickEditData:null})},confirm:function(e){var t=e.comic,c=e.slug,o=e.status,i=e.title,l=e.slugData,s=a.props.dispatch,n=a.state.selectedRowKeys;a.modal.cancel(),c?s({type:"comic/putComicInfo",payload:{params:{slug:l},data:{status:o,title:i,slug:c,"category.comic":t}}}):n.length>0?(s({type:"comic/putComicBatch",payload:{data:{type:"batch",list:n,data:{"category.comic":t,status:o}}},addon:a.query}),a.setState({selectedRowKeys:[]})):s({type:"comic/putComicBatch",payload:{data:{type:"all",data:{"category.comic":t,status:o}}},addon:a.query})}},a.deleteBatch=function(e){var t=a.props.dispatch,c=a.state.selectedRowKeys;t(e?{type:"comic/deleteComicBatch",payload:{data:{type:"all"}},addon:a.query}:{type:"comic/deleteComicBatch",payload:{data:{type:"batch",list:c}},addon:a.query})},a.onSearchComic=function(e){a.query.title=e,a.query.page=1,a.queryComic()},a.onChangeTable=function(e,t,c){var o=e.current,i=e.pageSize,l=t["category.comic.slug"]?t["category.comic.slug"][0]:null,s=t["information.isUpdate"]?t["information.isUpdate"][0]:null,n=t.status?t.status[0]:null,r=null;if(c.order){var m="descend"===c.order?"-":"",d=c.field;r="".concat(m).concat(d)}a.query={size:i,page:o,sort:r,comic:l,isUpdate:s,status:n},a.queryComic()},a.queryComic=function(){var e=q()(a),t=e.query,c=a.props.dispatch;c({type:"comic/queryComic",payload:{query:t}});var o=a.props,i=o.location.pathname,l=o.history;l.push({pathname:i,state:a.query})};var c=e.location.state,o=void 0===c?{}:c;return a.state={selectedRowKeys:[],quickEditStatus:!1,quickEditData:null},a.query={title:o.title,size:o.size?parseInt(o.size):10,page:o.page?parseInt(o.page):1,sort:o.sort,comic:o.comic,isUpdate:o.list?"true"===o.list:null,status:o.status},a}return x()(t,e),O()(t,[{key:"componentDidMount",value:function(){this.queryComic()}},{key:"render",value:function(){var e=this,t=this.state,a=t.selectedRowKeys,c=t.quickEditStatus,o=t.quickEditData,i=this.props,b=i.comic,h=b.list,y=b.total,j=i.category,O=i.category.comic,E=i.loading,M={comic:Object(Y["g"])(O).map(function(e){return{text:e.slug,value:e._id}})},k={draft:{text:Object(B["formatMessage"])({id:"common.draft"}),badge:"processing",value:"draft"},publish:{text:Object(B["formatMessage"])({id:"common.publish"}),badge:"success",value:"publish"},reject:{text:Object(B["formatMessage"])({id:"common.reject"}),badge:"error",value:"reject"}},v=[{text:Object(B["formatMessage"])({id:"common.update.in"}),value:!0},{text:Object(B["formatMessage"])({id:"common.update.out"}),value:!1}],C=[{title:Object(B["formatMessage"])({id:"comic.title"}),dataIndex:"title",key:"title",width:200,sorter:!0,render:function(t,a){return D.a.createElement("span",null,D.a.createElement("a",{onClick:e.list.fullEdit(a.slug)},t))}},{title:Object(B["formatMessage"])({id:"comic.slug"}),dataIndex:"slug",sorter:!0},{title:Object(B["formatMessage"])({id:"comic.author"}),dataIndex:"author.name",sorter:!0},{title:Object(B["formatMessage"])({id:"comic.update"}),dataIndex:"information.isUpdate",filters:Object.values(v),filterMultiple:!1,render:function(e){return e?Object(B["formatMessage"])({id:"common.update.in"}):Object(B["formatMessage"])({id:"common.update.out"})}},{title:Object(B["formatMessage"])({id:"comic.comment"}),dataIndex:"count.comment",sorter:!0},{title:Object(B["formatMessage"])({id:"comic.play"}),dataIndex:"count.play",sorter:!0},{title:Object(B["formatMessage"])({id:"comic.like"}),dataIndex:"count.like",sorter:!0},{title:Object(B["formatMessage"])({id:"comic.unlike"}),dataIndex:"count.unlike",sorter:!0},{title:Object(B["formatMessage"])({id:"comic.category.comic"}),dataIndex:"category.comic.slug",filters:M.comic,filterMultiple:!1},{title:Object(B["formatMessage"])({id:"comic.status"}),dataIndex:"status",filters:Object.values(k),filterMultiple:!1,render:function(e){return D.a.createElement(g["a"],{status:k[e].badge,text:k[e].text})}},{title:Object(B["formatMessage"])({id:"comic.updatedTime"}),dataIndex:"updatedAt",sorter:!0,width:120,align:"center",render:function(e){return z()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:Object(B["formatMessage"])({id:"comic.option"}),key:"action",dataIndex:"slug",render:function(t,a){return D.a.createElement("span",null,D.a.createElement("a",{onClick:e.list.quickEdit(a)},Object(B["formatMessage"])({id:"comic.option.quick.edit"})),D.a.createElement(f["a"],{type:"vertical"}),D.a.createElement("a",{onClick:e.list.fullEdit(t)},Object(B["formatMessage"])({id:"comic.option.full.edit"})),D.a.createElement(f["a"],{type:"vertical"}),D.a.createElement("a",{onClick:e.list.fulldelete(t)},Object(B["formatMessage"])({id:"comic.option.full.delete"})))}}],q=D.a.createElement(p["b"],{onClick:this.table.moreOption},D.a.createElement(p["b"].Item,{key:"edit"},Object(B["formatMessage"])({id:"comic.option.batch.all.edit"})),D.a.createElement(p["b"].Item,{key:"delete"},Object(B["formatMessage"])({id:"comic.option.batch.all.delete"}))),w={selectedRowKeys:a,onChange:function(t){e.setState({selectedRowKeys:t})}},x={showSizeChanger:!0,showQuickJumper:!0,total:y,defaultCurrent:this.query.page,defaultPageSize:this.query.size,showTotal:function(e){return"".concat(Object(B["formatMessage"])({id:"common.all.total"})," ").concat(e," ").concat(Object(B["formatMessage"])({id:"common.all.item"}))}};return D.a.createElement(l["a"],{className:"tableList",bordered:!1},D.a.createElement(n["a"],{className:"head"},D.a.createElement(r["a"],{span:16},D.a.createElement(u["a"],{icon:"plus",type:"primary",onClick:this.table.addNew},Object(B["formatMessage"])({id:"common.add.new"})),a.length>0&&D.a.createElement("span",null,D.a.createElement(u["a"],{onClick:this.table.batchEdit},"\u6279\u91cf\u7f16\u8f91"),D.a.createElement(u["a"],{onClick:this.table.batchDelete},"\u6279\u91cf\u5220\u9664")),D.a.createElement(m["a"],{overlay:q},D.a.createElement(u["a"],null,Object(B["formatMessage"])({id:"common.more.option"})," ",D.a.createElement(d["a"],{type:"down"})))),D.a.createElement(r["a"],{span:8},D.a.createElement(Q,{placeholder:Object(B["formatMessage"])({id:"common.more.option"}),onSearch:this.onSearchComic,enterButton:!0}))),D.a.createElement(n["a"],null,D.a.createElement(s["a"],{className:"longTable",loading:E,rowKey:"slug",rowSelection:w,columns:C,onChange:this.onChangeTable,dataSource:h,pagination:x})),D.a.createElement(H,{show:c,data:o,category:j,modal:this.modal}))}}]),t}(I["Component"]),o=i))||o);t["default"]=X}}]);
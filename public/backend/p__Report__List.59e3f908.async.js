(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[25],{mIg0:function(e,t,a){"use strict";a.r(t);a("IzEo");var r,o,n,s,i,c,l=a("bx4M"),m=(a("g9YV"),a("wCAj")),d=(a("14J3"),a("BMrR")),u=(a("jCWc"),a("kPKH")),p=(a("+L6B"),a("2/Rp")),f=(a("/zsF"),a("PArb")),g=(a("Awhp"),a("KrTs")),b=(a("Telt"),a("Tckk")),h=(a("Q9mQ"),a("diRs")),y=(a("2qtc"),a("kLXV")),j=a("p0pE"),M=a.n(j),O=a("2Taf"),E=a.n(O),v=a("vZ4D"),w=a.n(v),k=a("l4Ni"),q=a.n(k),C=a("ujKo"),R=a.n(C),x=a("rlhR"),S=a.n(x),I=a("MhPg"),D=a.n(I),V=(a("5NDa"),a("5rEg")),T=a("q1tI"),z=a.n(T),K=a("MuoO"),P=a("7DNP"),A=a("LLXN"),F=a("wd/R"),B=a.n(F),L=(a("y8nQ"),a("Vl3Y")),N=a("jehZ"),Y=a.n(N),Q=(a("OaEy"),a("2fM7")),H=function(e){function t(){var e,a;E()(this,t);for(var r=arguments.length,o=new Array(r),n=0;n<r;n++)o[n]=arguments[n];return a=q()(this,(e=R()(t)).call.apply(e,[this].concat(o))),a.state={},a.handleSubmit=function(){var e=a.props,t=e.modal,r=e.form,o=e.data;r.validateFields(function(e,a){e||(t.confirm(M()({},o,a)),r.resetFields())})},a.handleCancel=function(){var e=a.props,t=e.modal,r=e.form;t.cancel(),r.resetFields()},a}return D()(t,e),w()(t,[{key:"render",value:function(){var e=Q["a"].Option,t=V["a"].TextArea,a=this.props.form.getFieldDecorator,r=this.props,o=r.show,n=r.data,s=r.modal,i={labelCol:{span:4},wrapperCol:{span:18}},c=n||{},l=c.reply,m=c.status;return z.a.createElement(y["a"],{title:Object(A["formatMessage"])({id:"common.quick.edit"}),visible:o,maskClosable:!1,forceRender:"true",onOk:this.handleSubmit,onCancel:this.handleCancel},z.a.createElement(L["a"],{onSubmit:s.submit},z.a.createElement(L["a"].Item,Y()({},i,{label:Object(A["formatMessage"])({id:"report.reply"})}),a("reply",{initialValue:l})(z.a.createElement(t,{placeholder:Object(A["formatMessage"])({id:"report.reply.tips"}),autosize:{minRows:4,maxRows:12}}))),z.a.createElement(L["a"].Item,Y()({},i,{label:Object(A["formatMessage"])({id:"report.status"})}),a("status",{initialValue:m||"draft",rules:[{required:!0,message:Object(A["formatMessage"])({id:"report.status.tips"})}]})(z.a.createElement(Q["a"],{placeholder:Object(A["formatMessage"])({id:"report.status.tips"})},z.a.createElement(e,{value:"draft"},Object(A["formatMessage"])({id:"report.status.draft"})),z.a.createElement(e,{value:"publish"},Object(A["formatMessage"])({id:"report.status.publish"})),z.a.createElement(e,{value:"reject"},Object(A["formatMessage"])({id:"report.status.reject"})))))))}}]),t}(T["PureComponent"]),J=L["a"].create()(H),U=(a("+n12"),a("T2oS"),a("W9HT")),_=a("7Q2D"),W=(r=Object(K["connect"])(function(e){var t=e.comment,a=e.loading;return{comment:t,loading:a.effects["comment/putComment"]}}),r((n=function(e){function t(){var e,a;E()(this,t);for(var r=arguments.length,o=new Array(r),n=0;n<r;n++)o[n]=arguments[n];return a=q()(this,(e=R()(t)).call.apply(e,[this].concat(o))),a.state={},a.handleSubmit=function(){var e=a.props,t=e.form,r=e.info._id,o=e.dispatch;t.validateFields(function(e,a){e||(o({type:"comment/putComment",payload:{params:{id:r},data:a}}),t.resetFields())})},a}return D()(t,e),w()(t,[{key:"render",value:function(){var e=Q["a"].Option,t=V["a"].TextArea,a=this.props.form.getFieldDecorator,r=this.props,o=r.info,n=o.content,s=o.image,i=o.video,c=o.status,l=r.loading,m={labelCol:{span:4},wrapperCol:{span:18}};return z.a.createElement(U["a"],{tip:"Loading...",spinning:!!l},z.a.createElement(L["a"],{style:{width:"600px"},onSubmit:this.handleSubmit},z.a.createElement(L["a"].Item,Y()({},m,{label:Object(A["formatMessage"])({id:"comment.content"})}),a("content",{initialValue:n,rules:[{required:!0,message:Object(A["formatMessage"])({id:"comment.content.tips"})}]})(z.a.createElement(t,{placeholder:Object(A["formatMessage"])({id:"comment.content.tips"}),autosize:{minRows:4,maxRows:12}}))),z.a.createElement(L["a"].Item,Y()({},m,{label:Object(A["formatMessage"])({id:"comment.image"})}),a("image",{initialValue:s})(z.a.createElement(_["a"],null))),z.a.createElement(L["a"].Item,Y()({},m,{label:Object(A["formatMessage"])({id:"comment.video"})}),a("video",{initialValue:i})(z.a.createElement(V["a"],{placeholder:Object(A["formatMessage"])({id:"comment.video.tips"})}))),z.a.createElement(L["a"].Item,Y()({},m,{label:Object(A["formatMessage"])({id:"comment.status"})}),a("status",{initialValue:c||"draft",rules:[{required:!0,message:Object(A["formatMessage"])({id:"comment.status.tips"})}]})(z.a.createElement(Q["a"],{placeholder:Object(A["formatMessage"])({id:"comment.status.tips"})},z.a.createElement(e,{value:"draft"},Object(A["formatMessage"])({id:"common.draft"})),z.a.createElement(e,{value:"publish"},Object(A["formatMessage"])({id:"common.publish"})),z.a.createElement(e,{value:"reject"},Object(A["formatMessage"])({id:"common.reject"}))))),z.a.createElement(L["a"].Item,{wrapperCol:{offset:4},label:""},z.a.createElement(p["a"],{type:"primary",htmlType:"submit"},Object(A["formatMessage"])({id:"comment.save"})))))}}]),t}(T["PureComponent"]),o=n))||o),X=L["a"].create()(W),Z=V["a"].Search,G=(s=Object(K["connect"])(function(e){var t=e.report,a=e.loading;return{report:t,loading:a.models.report}}),s((c=function(e){function t(e){var a;E()(this,t),a=q()(this,R()(t).call(this,e)),a.list={edit:function(e){return function(){a.setState({quickEditData:M()({},e,{kind:"edit"})}),a.modal.show()}},remove:function(e){return function(){var t=a.props.dispatch;t({type:"report/deleteReport",payload:{params:{id:e}},addon:a.query})}},routerPush:function(e){return function(){var t=a.props.dispatch;t(P["routerRedux"].push(e))}}},a.table={edit:function(){a.setState({quickEditStatus:!0})},remove:function(e){return function(){var t="all"===e?Object(A["formatMessage"])({id:"report.delete.all.tips"}):Object(A["formatMessage"])({id:"report.delete.batch.tips"});y["a"].confirm({title:Object(A["formatMessage"])({id:"report.delete"}),content:t,okText:Object(A["formatMessage"])({id:"common.confirm"}),cancelText:Object(A["formatMessage"])({id:"common.cancel"}),onOk:function(){a.deleteBatch(e),a.setState({selectedRowKeys:[]})}})}}},a.modal={show:function(){a.setState({quickEditStatus:!0})},cancel:function(){a.setState({quickEditStatus:!1,quickEditData:null})},confirm:function(e){var t=e.reply,r=e.status,o=e._id,n=a.props.dispatch,s=a.state.selectedRowKeys;if(o)n({type:"report/putReport",payload:{params:{id:o},data:{reply:t,status:r}},addon:a.query});else{var i=s.length>0?"batch":"all";n({type:"report/putReportBatch",payload:{data:{type:i,list:s,data:{reply:t,status:r}}},addon:a.query}),a.setState({selectedRowKeys:[]})}a.modal.cancel()}},a.imgView={show:function(e){return function(){a.setState({imgView:!0,imgUrl:e})}},hide:function(){a.setState({imgView:!1,imgUrl:null})}},a.deleteBatch=function(e){var t=a.props.dispatch,r=a.state.selectedRowKeys;t({type:"report/deleteReportBatch",payload:{data:{type:e,list:r}},addon:a.query})},a.onSearchReport=function(e){a.query.content=e,a.query.page=1,a.queryReport()},a.onChangeTable=function(e,t,r){var o=e.current,n=e.pageSize,s=t.status?t.status[0]:null,i=t.type?t.type[0]:null,c=null;if(r.order){var l="descend"===r.order?"-":"",m=r.field;c="".concat(l).concat(m)}a.query={size:n,page:o,sort:c,status:s,type:i},a.queryReport()},a.queryReport=function(){var e=S()(a),t=e.query,r=a.props.dispatch;r({type:"report/queryReport",payload:{query:t}});var o=a.props,n=o.location.pathname,s=o.history;s.push({pathname:n,state:a.query})};var r=e.location.state,o=void 0===r?{}:r;return a.state={selectedRowKeys:[],quickEditStatus:!1,quickEditData:null,imgView:!1,imgUrl:null},a.query={content:o.content,size:o.size?parseInt(o.size):10,page:o.page?parseInt(o.page):1,sort:o.sort,type:o.type,status:o.status},a}return D()(t,e),w()(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.belong,a=e.type;this.query={belong:t,type:a},this.queryReport()}},{key:"render",value:function(){var e=this,t=this.state,a=t.selectedRowKeys,r=t.quickEditStatus,o=t.quickEditData,n=t.imgView,s=t.imgUrl,i=this.props,c=i.report,j=c.list,M=c.total,O=i.loading,E={draft:{text:Object(A["formatMessage"])({id:"report.status.draft"}),badge:"processing",value:"draft"},publish:{text:Object(A["formatMessage"])({id:"report.status.publish"}),badge:"success",value:"publish"},reject:{text:Object(A["formatMessage"])({id:"report.status.reject"}),badge:"error",value:"reject"}},v={animate:{text:Object(A["formatMessage"])({id:"report.type.animate"}),value:"animate"},post:{text:Object(A["formatMessage"])({id:"report.type.post"}),value:"post"},comic:{text:Object(A["formatMessage"])({id:"report.type.comic"}),value:"comic"},comment:{text:Object(A["formatMessage"])({id:"report.type.comment"}),value:"comment"},others:{text:Object(A["formatMessage"])({id:"report.type.others"}),value:"others"}},w=[{title:Object(A["formatMessage"])({id:"report.target"}),dataIndex:"title",key:"title",render:function(t){var a;switch(t.type){case"animate":a=t.animate?z.a.createElement("a",{onClick:e.list.routerPush("/animate/slug/".concat(t.animate.slug))},t.animate.title):Object(A["formatMessage"])({id:"report.isDelete"});break;case"comic":a=t.comic?z.a.createElement("a",{onClick:e.list.routerPush("/comic/slug/".concat(t.comic.slug))},t.comic.title):Object(A["formatMessage"])({id:"report.isDelete"});break;case"post":a=t.post?z.a.createElement("a",{onClick:e.list.routerPush("/post/slug/".concat(t.post.slug))},t.post.title):Object(A["formatMessage"])({id:"report.isDelete"});break;case"comment":a=t.comment?z.a.createElement(h["a"],{placement:"right",content:z.a.createElement(X,{info:t.comment}),trigger:"click"},z.a.createElement("a",null,Object(A["formatMessage"])({id:"report.goInfo"}))):Object(A["formatMessage"])({id:"report.isDelete"});break;default:a=Object(A["formatMessage"])({id:"report.others"});break}return a}},{title:Object(A["formatMessage"])({id:"report.type"}),dataIndex:"type",filters:Object.values(v),filterMultiple:!1,render:function(e){return z.a.createElement("span",null,v[e].text)}},{title:Object(A["formatMessage"])({id:"report.author"}),dataIndex:"author.name",sorter:!0},{title:Object(A["formatMessage"])({id:"report.content"}),dataIndex:"content",render:function(e){return e.slice(0,50)}},{title:Object(A["formatMessage"])({id:"report.image"}),dataIndex:"image",align:"center",render:function(t){return t.length>0?t.slice(0,3).map(function(t){return z.a.createElement(b["a"],{shape:"square",size:64,icon:"user",src:t,key:t,style:{marginRight:"15px"},onClick:e.imgView.show(t)})}):Object(A["formatMessage"])({id:"report.nocontent"})}},{title:Object(A["formatMessage"])({id:"report.status"}),dataIndex:"status",filters:Object.values(E),filterMultiple:!1,render:function(e){return z.a.createElement(g["a"],{status:E[e].badge,text:E[e].text})}},{title:Object(A["formatMessage"])({id:"report.reply"}),dataIndex:"reply"},{title:Object(A["formatMessage"])({id:"report.createdAt"}),dataIndex:"createdAt",sorter:!0,render:function(e){return B()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:Object(A["formatMessage"])({id:"report.option"}),key:"action",dataIndex:"_id",width:150,render:function(t,a){return z.a.createElement("span",null,z.a.createElement("a",{onClick:e.list.edit(a)},Object(A["formatMessage"])({id:"report.option.reply"})),z.a.createElement(f["a"],{type:"vertical"}),z.a.createElement("a",{onClick:e.list.remove(t)},Object(A["formatMessage"])({id:"report.option.delete"})))}}],k={selectedRowKeys:a,onChange:function(t){e.setState({selectedRowKeys:t})}},q={showSizeChanger:!0,showQuickJumper:!0,total:M,defaultCurrent:this.query.page,defaultPageSize:this.query.size,showTotal:function(e){return"".concat(Object(A["formatMessage"])({id:"common.all.total"})," ").concat(e," ").concat(Object(A["formatMessage"])({id:"common.all.item"}))}};return z.a.createElement(l["a"],{className:"tableList",bordered:!1},z.a.createElement(d["a"],{className:"head"},z.a.createElement(u["a"],{span:16},z.a.createElement(p["a"],{type:"primary",onClick:this.table.edit},Object(A["formatMessage"])({id:"common.edit.all"})),z.a.createElement(p["a"],{onClick:this.table.remove("all")},Object(A["formatMessage"])({id:"common.delete.all"})),a.length>0&&z.a.createElement("span",null,z.a.createElement(p["a"],{onClick:this.table.edit},Object(A["formatMessage"])({id:"common.edit.batch"})),z.a.createElement(p["a"],{onClick:this.table.remove("batch")},Object(A["formatMessage"])({id:"common.delete.batch"})))),z.a.createElement(u["a"],{span:8},z.a.createElement(Z,{placeholder:Object(A["formatMessage"])({id:"report.search"}),onSearch:this.onSearchReport,enterButton:!0}))),z.a.createElement(d["a"],null,z.a.createElement(m["a"],{loading:O,rowKey:"_id",rowSelection:k,columns:w,onChange:this.onChangeTable,dataSource:j,pagination:q})),z.a.createElement(J,{show:r,data:o,modal:this.modal}),z.a.createElement(y["a"],{visible:n,footer:null,onCancel:this.imgView.hide},z.a.createElement("img",{alt:Object(A["formatMessage"])({id:"common.image"}),style:{width:"100%"},src:s})))}}]),t}(T["Component"]),i=c))||i);t["default"]=G}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[27],{GHaO:function(e,t,a){"use strict";a.r(t);a("IzEo");var o,s,i,r=a("bx4M"),c=(a("g9YV"),a("wCAj")),n=(a("14J3"),a("BMrR")),l=(a("jCWc"),a("kPKH")),d=(a("qVdP"),a("jsC+")),u=(a("Pwec"),a("CtXQ")),p=(a("+L6B"),a("2/Rp")),m=(a("lUTK"),a("BvKs")),h=(a("/zsF"),a("PArb")),f=(a("Awhp"),a("KrTs")),b=(a("Telt"),a("Tckk")),E=(a("2qtc"),a("kLXV")),g=a("p0pE"),y=a.n(g),v=a("2Taf"),O=a.n(v),M=a("vZ4D"),j=a.n(M),k=a("l4Ni"),S=a.n(k),w=a("ujKo"),x=a.n(w),q=a("rlhR"),C=a.n(q),I=a("MhPg"),D=a.n(I),R=(a("5NDa"),a("5rEg")),L=a("q1tI"),K=a.n(L),T=a("MuoO"),V=a("LLXN"),z=a("wd/R"),B=a.n(z),A=(a("y8nQ"),a("Vl3Y")),N=a("jehZ"),F=a.n(N),P=(a("giR+"),a("fyUT")),Y=(a("OaEy"),a("2fM7")),_=a("zX7x"),H=R["a"].TextArea,J=function(e){function t(){var e,a;O()(this,t);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return a=S()(this,(e=x()(t)).call.apply(e,[this].concat(s))),a.state={},a.handleSubmit=function(){var e=a.props,t=e.modal,o=e.form,s=e.data,i=s.type,r=s._id;o.validateFields(function(e,a){e||(t.confirm(y()({},a,{type:i,_id:r})),o.resetFields())})},a.handleCancel=function(){var e=a.props,t=e.modal,o=e.form;t.cancel(),o.resetFields()},a}return D()(t,e),j()(t,[{key:"render",value:function(){var e=Y["a"].Option,t=this.props.form.getFieldDecorator,a=this.props,o=a.show,s=a.data,i=a.modal,r={labelCol:{span:6},wrapperCol:{span:16}},c=s||{},n=c.type,l=c.title,d=c.status,u=c.price,p=c.upLevel,m=c.addScore,h=c.addExpired,f=c.introduce,b=c.cover;return K.a.createElement(E["a"],{title:Object(V["formatMessage"])({id:"shop.quick.edit"}),visible:o,maskClosable:!1,forceRender:"true",centered:!0,onOk:this.handleSubmit,onCancel:this.handleCancel},K.a.createElement(A["a"],{onSubmit:i.submit},"batchEdit"!==n?K.a.createElement(A["a"].Item,F()({},r,{label:Object(V["formatMessage"])({id:"shop.price"})}),t("price",{initialValue:u,rules:[{required:!0,message:Object(V["formatMessage"])({id:"shop.price.tips"})}]})(K.a.createElement(P["a"],{style:{width:200}}))):K.a.createElement(A["a"].Item,F()({},r,{label:Object(V["formatMessage"])({id:"shop.price"}),extra:Object(V["formatMessage"])({id:"shop.empty.tips"})}),t("price",{initialValue:u})(K.a.createElement(P["a"],{style:{width:200}}))),K.a.createElement(A["a"].Item,F()({},r,{label:Object(V["formatMessage"])({id:"shop.addLevel"}),extra:Object(V["formatMessage"])({id:"shop.addLevel.extra"})}),t("upLevel",{initialValue:p})(K.a.createElement(P["a"],{style:{width:200}}))),K.a.createElement(A["a"].Item,F()({},r,{label:Object(V["formatMessage"])({id:"shop.addScore"})}),t("addScore",{initialValue:m})(K.a.createElement(P["a"],{style:{width:200}}))),K.a.createElement(A["a"].Item,F()({},r,{label:Object(V["formatMessage"])({id:"shop.addExpired"}),extra:Object(V["formatMessage"])({id:"shop.addExpired.extra"})}),t("addExpired",{initialValue:h})(K.a.createElement(P["a"],{style:{width:200}}))),K.a.createElement(A["a"].Item,F()({},r,{label:Object(V["formatMessage"])({id:"shop.cover"})}),t("cover",{initialValue:b})(K.a.createElement(_["a"],null))),"batchEdit"!==n&&K.a.createElement(A["a"].Item,F()({},r,{label:Object(V["formatMessage"])({id:"shop.title"})}),t("title",{initialValue:l,rules:[{required:!0,message:Object(V["formatMessage"])({id:"shop.title"})}]})(K.a.createElement(R["a"],{placeholder:Object(V["formatMessage"])({id:"shop.title"})}))),K.a.createElement(A["a"].Item,F()({},r,{label:Object(V["formatMessage"])({id:"shop.status"})}),t("status",{initialValue:d||"unactive",rules:[{required:!0,message:Object(V["formatMessage"])({id:"shop.status"})}]})(K.a.createElement(Y["a"],{placeholder:Object(V["formatMessage"])({id:"shop.status.extra"})},K.a.createElement(e,{value:"unactive"},Object(V["formatMessage"])({id:"shop.status.unactive"})),K.a.createElement(e,{value:"active"},Object(V["formatMessage"])({id:"shop.status.active"}))))),"batchEdit"!==n&&K.a.createElement(A["a"].Item,F()({},r,{label:Object(V["formatMessage"])({id:"shop.introduce"}),extra:Object(V["formatMessage"])({id:"shop.introduce.extra"})}),t("introduce",{initialValue:f})(K.a.createElement(H,{placeholder:Object(V["formatMessage"])({id:"shop.introduce.tips"}),autosize:{minRows:3,maxRows:6}})))))}}]),t}(L["PureComponent"]),X=A["a"].create()(J),Q=R["a"].Search,U=(o=Object(T["connect"])(function(e){var t=e.shop,a=e.loading;return{shop:t,loading:a.effects["shop/queryShop"]}}),o((i=function(e){function t(){var e,a;O()(this,t);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return a=S()(this,(e=x()(t)).call.apply(e,[this].concat(s))),a.state={selectedRowKeys:[],quickEditStatus:!1,quickEditData:null},a.query={title:null,size:null,page:null,sort:null,status:null},a.list={edit:function(e){return function(){a.setState({quickEditData:y()({},e,{type:"quickEdit"})}),a.modal.show()}},remove:function(e){return function(){var t=a.props.dispatch;t({type:"shop/deleteShop",payload:{params:{id:e}}})}}},a.table={addNew:function(){a.setState({quickEditData:{type:"add"}}),a.modal.show()},batchEdit:function(){a.setState({quickEditStatus:!0,quickEditData:{type:"batchEdit"}})},batchDelete:function(){E["a"].confirm({title:Object(V["formatMessage"])({id:"shop.delete.key"}),content:Object(V["formatMessage"])({id:"shop.delete.key.tips.batch"}),okText:Object(V["formatMessage"])({id:"common.confirm"}),cancelText:Object(V["formatMessage"])({id:"common.cancel"}),onOk:function(){a.deleteBatch("batch"),a.setState({selectedRowKeys:[]})}})},moreOption:function(e){switch(e.key){case"edit":a.table.allEdit();break;case"delete":a.table.allDelete();break;default:break}},allEdit:function(){a.setState({quickEditStatus:!0,quickEditData:{type:"batchEdit"}})},allDelete:function(){E["a"].confirm({title:Object(V["formatMessage"])({id:"shop.delete.key"}),content:Object(V["formatMessage"])({id:"shop.delete.key.tips.all"}),okText:Object(V["formatMessage"])({id:"common.confirm"}),cancelText:Object(V["formatMessage"])({id:"common.cancel"}),onOk:function(){a.deleteBatch("all"),a.setState({selectedRowKeys:[]})}})}},a.modal={show:function(){a.setState({quickEditStatus:!0})},cancel:function(){a.setState({quickEditStatus:!1,quickEditData:null})},confirm:function(e){var t=e.type,o=e.title,s=e.status,i=e.price,r=e.upLevel,c=e.addScore,n=e.addExpired,l=e.introduce,d=e.cover,u=e._id,p=a.props.dispatch,m=a.state.selectedRowKeys;if(a.modal.cancel(),"add"===t)p({type:"shop/postShop",payload:{data:{title:o,status:s,price:i,upLevel:r,addScore:c,addExpired:n,introduce:l,cover:d}}});else if("quickEdit"===t)p({type:"shop/putShop",payload:{params:{id:u},data:{title:o,status:s,price:i,upLevel:r,addScore:c,addExpired:n,introduce:l,cover:d}},addon:a.query});else{var h=m.length>0?"batch":"all";p({type:"shop/putShopBatch",payload:{data:{type:h,list:m,data:{status:s,price:i,upLevel:r,addScore:c,addExpired:n,introduce:l,cover:d}}},addon:a.query})}}},a.deleteBatch=function(e){var t=a.props.dispatch,o=a.state.selectedRowKeys;t({type:"shop/deleteBatch",payload:{data:{type:e,list:o}},addon:a.query})},a.onSearchShop=function(e){a.query.title=e,a.queryShop()},a.onChangeTable=function(e,t,o){var s=e.current,i=e.pageSize,r=t.status?t.status[0]:null,c=null;if(o.order){var n="descend"===o.order?"-":"",l=o.field;c="".concat(n).concat(l)}a.query={size:i,page:s,sort:c,status:r},a.queryShop()},a.queryShop=function(){var e=C()(a),t=e.query,o=a.props.dispatch;o({type:"shop/queryShop",payload:{query:t}})},a}return D()(t,e),j()(t,[{key:"componentDidMount",value:function(){this.queryShop()}},{key:"render",value:function(){var e=this,t=this.state,a=t.selectedRowKeys,o=t.quickEditStatus,s=t.quickEditData,i=this.props,E=i.shop.shop,g=E.list,y=E.total,v=i.loading,O={unactive:{text:Object(V["formatMessage"])({id:"shop.status.unactive"}),badge:"processing",value:"unactive"},active:{text:Object(V["formatMessage"])({id:"shop.status.active"}),badge:"error",value:"active"}},M=[{title:Object(V["formatMessage"])({id:"shop.title"}),dataIndex:"title",key:"title",width:200,sorter:!0},{title:Object(V["formatMessage"])({id:"shop.price"}),dataIndex:"price",sorter:!0},{title:Object(V["formatMessage"])({id:"shop.addLevel"}),dataIndex:"upLevel",sorter:!0},{title:Object(V["formatMessage"])({id:"shop.addScore"}),dataIndex:"addScore",sorter:!0},{title:Object(V["formatMessage"])({id:"shop.addExpired"}),dataIndex:"addExpired",sorter:!0,render:function(e){return"".concat((e/3600/24).toFixed(2),"\u5929")}},{title:Object(V["formatMessage"])({id:"shop.introduce"}),dataIndex:"introduce"},{title:Object(V["formatMessage"])({id:"shop.cover"}),dataIndex:"cover",render:function(e){return K.a.createElement(b["a"],{src:e,size:60,shape:"square"})}},{title:Object(V["formatMessage"])({id:"shop.status"}),dataIndex:"status",filters:Object.values(O),filterMultiple:!1,render:function(e){return K.a.createElement(f["a"],{status:O[e].badge,text:O[e].text})}},{title:Object(V["formatMessage"])({id:"shop.createdAt"}),dataIndex:"createdAt",sorter:!0,width:120,align:"center",render:function(e){return B()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:Object(V["formatMessage"])({id:"shop.option"}),key:"action",dataIndex:"_id",render:function(t,a){return K.a.createElement("span",null,K.a.createElement("a",{onClick:e.list.edit(a)},Object(V["formatMessage"])({id:"common.edit"})),K.a.createElement(h["a"],{type:"vertical"}),K.a.createElement("a",{onClick:e.list.remove(t)},Object(V["formatMessage"])({id:"common.delete"})))}}],j=K.a.createElement(m["b"],{onClick:this.table.moreOption},K.a.createElement(m["b"].Item,{key:"edit"},Object(V["formatMessage"])({id:"common.edit.all"})),K.a.createElement(m["b"].Item,{key:"delete"},Object(V["formatMessage"])({id:"common.delete.all"}))),k={selectedRowKeys:a,onChange:function(t){e.setState({selectedRowKeys:t})}},S={showSizeChanger:!0,showQuickJumper:!0,total:y,showTotal:function(e){return"".concat(Object(V["formatMessage"])({id:"common.all.total"})," ").concat(e," ").concat(Object(V["formatMessage"])({id:"common.all.item"}))}};return K.a.createElement(r["a"],{className:"tableList",bordered:!1},K.a.createElement(n["a"],{className:"head"},K.a.createElement(l["a"],{span:16},K.a.createElement(p["a"],{icon:"plus",type:"primary",onClick:this.table.addNew},Object(V["formatMessage"])({id:"common.add.new"})),a.length>0&&K.a.createElement("span",null,K.a.createElement(p["a"],{onClick:this.table.batchEdit},Object(V["formatMessage"])({id:"common.edit.batch"})),K.a.createElement(p["a"],{onClick:this.table.batchDelete},Object(V["formatMessage"])({id:"common.remove.batch"}))),K.a.createElement(d["a"],{overlay:j},K.a.createElement(p["a"],null,Object(V["formatMessage"])({id:"common.more.option"})," ",K.a.createElement(u["a"],{type:"down"})))),K.a.createElement(l["a"],{span:8},K.a.createElement(Q,{placeholder:Object(V["formatMessage"])({id:"shop.search.list"}),onSearch:this.onSearchShop,enterButton:!0}))),K.a.createElement(n["a"],null,K.a.createElement(c["a"],{loading:v,rowKey:"_id",rowSelection:k,columns:M,onChange:this.onChangeTable,dataSource:g,pagination:S})),K.a.createElement(X,{show:o,data:s,modal:this.modal}))}}]),t}(L["Component"]),s=i))||s);t["default"]=U}}]);
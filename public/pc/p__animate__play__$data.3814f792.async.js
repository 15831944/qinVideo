(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"8S6H":function(e,n,a){"use strict";a.r(n);a("R9oj");var t=a("ECub"),r=(a("miYZ"),a("tsqr")),i=a("mrSG"),l=a("q1tI"),o=a.n(l),c=a("MuoO"),s=(a("IzEo"),a("bx4M")),m=(a("+L6B"),a("2/Rp")),p=(a("5Dmo"),a("3S7+")),d=a("qIgq"),u=a.n(d),g=a("fFZ8"),h=a.n(g),b=a("vOnD"),f=a("XEok"),v=a("LLXN"),E=a("yDSA"),y=(a("T2oS"),a("W9HT")),x=a("Dp36"),j=a("wd/R"),O=a.n(j),w=a("bdvc");function N(){var e=h()(["\n  margin: 0 20px;\n\n  .head {\n    height: 30px;\n    line-height: 30px;\n    display: grid;\n    grid-template-columns: 50px 1fr 60px;\n    font-size: 0.9em;\n    opacity: 0.6;\n    font-weight: 700;\n  }\n\n  .main {\n    .list {\n      line-height: 24px;\n      display: grid;\n      grid-template-columns: 50px 170px 60px;\n      font-size: 0.8em;\n      opacity: 0.6;\n      cursor: pointer;\n\n      span:nth-child(2) {\n        font-weight: 500;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: pre;\n        word-break: keep-all;\n      }\n\n      span:nth-child(3) {\n        text-align: center;\n      }\n\n      &:hover {\n        color: ",";\n      }\n    }\n  }\n"]);return N=function(){return e},e}var k=e=>{var n=Math.floor(e/60),a=Math.floor(e%60);return"".concat(Object(w["a"])(n),":").concat(Object(w["a"])(a))},M=b["a"].div(N(),e=>e.color),I=e=>{var n=e.id,a=Object(l["useContext"])(f["a"]),t=Object(l["useMemo"])(()=>a,[a]),r=Object(l["useState"])([]),i=u()(r,2),c=i[0],s=i[1],m=Object(l["useState"])(!0),p=u()(m,2),d=p[0],g=p[1];return Object(l["useEffect"])(()=>{x["a"].queryDanmu({query:{id:n}}).then(e=>{s(e.data),g(!1)})},[e.id]),o.a.createElement(M,{color:t},o.a.createElement("div",{className:"head"},o.a.createElement("span",null,Object(v["formatMessage"])({id:"danmu.time"})),o.a.createElement("span",null,Object(v["formatMessage"])({id:"danmu.content"})),o.a.createElement("span",null,Object(v["formatMessage"])({id:"danmu.created"}))),o.a.createElement(y["a"],{spinning:d},o.a.createElement("div",{className:"main"},c.map(e=>o.a.createElement("div",{className:"list"},o.a.createElement("span",null,k(e.time)),o.a.createElement("span",null,e.text),o.a.createElement("span",null,O()(e.createdAt).format("MM-DD")))))))},D=I,S=a("8KYf"),q=a("mNhR"),z=a("3a4m"),C=a.n(z),R=a("eNRF"),F=(a("Quhn"),a("NUga")),Y=a.n(F),H=a("ulZh"),L=a.n(H),P=e=>{var n=e.target,a=e.info,t=e.type,r=Object(l["useContext"])(f["a"]),i=Object(l["useMemo"])(()=>r,[r]);window.Hls=L.a;var c=e=>{var n=e.color,a=e.id,t=e.link,r=e.type,i=window.config.dplayer||"http://api.btstu.cn/sjbz/?lx=dongman",l={container:document.getElementById("dplayer"),autoplay:!0,theme:n,screenshot:!1,hotkey:!0,preload:"auto",volume:.7,mutex:!0,video:{url:t,pic:i,type:"mp4"===r?"auto":"hls"},danmaku:{id:a,api:"/api/v1/danmu/list/",maximum:1e3,bottom:"15%",unlimited:!0}};new Y.a(l)};return Object(l["useEffect"])(()=>{"php"!==t&&c({color:i,id:n,link:a.link,type:t})},[e.target]),o.a.createElement(o.a.Fragment,null,"php"===t?o.a.createElement("iframe",{style:{width:"100%",height:"100%",border:"none"},src:a.link}):o.a.createElement("div",{id:"dplayer"}))},T=P,Z=a("l61h");function A(){var e=h()(["\n  padding: 60px;\n  .container {\n    display: grid;\n    grid-template-columns: 1fr 320px;\n    grid-gap: 20px;\n\n    .player {\n      background-color: rgba(0, 0, 0, 0.1);\n    }\n\n    .sidebar {\n      background-color: white;\n      padding: 5px 20px 0px 20px;\n\n      .header {\n        height: 40px;\n\n        span {\n          display: inline-block;\n          width: 50%;\n          height: 40px;\n          line-height: 40px;\n          cursor: pointer;\n          text-align: center;\n          border-bottom: solid 2px transparent;\n\n          &.active {\n            border-bottom-color: ",";\n          }\n        }\n      }\n\n      .content {\n        height: calc(100% - 50px);\n        overflow-y: scroll;\n        margin: 5px -20px;\n\n        .eposide,\n        .danmu {\n          display: none;\n        }\n\n        .eposide.active,\n        .danmu.active {\n          display: block;\n        }\n      }\n    }\n\n    .comment {\n      .report {\n        padding: 24px;\n        background-color: white;\n        border-radius: 2px;\n        margin-bottom: 20px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n\n        .title {\n          span {\n            margin-right: 30px;\n\n            i {\n              margin-right: 5px;\n            }\n          }\n        }\n\n        .btn .ant-btn.ant-btn-primary {\n          font-size: 12px;\n        }\n      }\n    }\n\n    .info {\n      .info-main {\n        .cover {\n          width: 112px;\n          height: 144px;\n          border-radius: 2px;\n          background-color: rgba(0, 0, 0, 0.05);\n          margin: 0 auto;\n          box-shadow: 0 3px 14px 0 hsla(22, 4%, 52%, 0.4);\n          background-size: cover;\n          background-position: center;\n          cursor: pointer;\n        }\n        .title {\n          font-size: 1.2em;\n          height: 50px;\n          line-height: 60px;\n          width: 100%;\n          text-align: center;\n          text-overflow: ellipsis;\n          overflow: hidden;\n          white-space: keep-all;\n        }\n        .introduce {\n          color: #515a6e;\n        }\n      }\n    }\n  }\n"]);return A=function(){return e},e}var B=b["a"].div(A(),e=>e.color),J=e=>{var n=e.play,a="".concat(n.slug,"S").concat(n.season.season,"E").concat(n.season.eposide),t="S".concat(n.season.season,"E").concat(n.season.eposide),r=Object(l["useContext"])(f["a"]),i=Object(l["useMemo"])(()=>r,[r]),c=Object(l["useState"])(0),d=u()(c,2),g=d[0],h=d[1],b=Object(l["useState"])(200),y=u()(b,2),x=y[0],j=y[1],O=Object(l["useRef"])(null),N=Object(l["useRef"])(null);return Object(l["useEffect"])(()=>{j(.5625*O.current.clientWidth),N.current.scrollTop=80*n.season.eposide}),o.a.createElement(B,{color:i},o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"player",ref:O,style:{height:x}},o.a.createElement(T,{target:a,info:n.playInfo,type:n.play.kind})),o.a.createElement("div",{className:"sidebar",style:{height:x}},o.a.createElement("div",{className:"header"},["eposide","danmu"].map((e,n)=>o.a.createElement("span",{className:g===n?"active":"",onClick:()=>{h(n)}},Object(v["formatMessage"])({id:"animate.play.tabs.".concat(e)})))),o.a.createElement("div",{className:"content",ref:N},o.a.createElement("div",{className:0===g?"eposide active":"eposide"},o.a.createElement(E["a"],{slug:n.slug,cover:n.cover.vertical,eposide:n.season})),o.a.createElement("div",{className:1===g?"danmu active":"danmu"},o.a.createElement(D,{id:a})))),o.a.createElement("div",{className:"comment"},o.a.createElement("div",{className:"report"},o.a.createElement("div",{className:"title"},o.a.createElement("span",null,n.title," - ",Object(w["a"])(parseInt(n.season.eposide)+1)," :"," ",n.playInfo.title),o.a.createElement(p["a"],{placement:"top",title:Object(v["formatMessage"])({id:"animate.info.play"})},o.a.createElement("span",null,o.a.createElement(q["a"],{type:"icon-youtube"}),n.count.play)),o.a.createElement(p["a"],{placement:"top",title:Object(v["formatMessage"])({id:"animate.info.comment"})},o.a.createElement("span",null,o.a.createElement(q["a"],{type:"icon-comment1"}),n.count.comment)),o.a.createElement(p["a"],{placement:"top",title:Object(v["formatMessage"])({id:"animate.info.danmu"})},o.a.createElement("span",null,o.a.createElement(q["a"],{type:"icon-pinglun"}),n.count.danmu))),o.a.createElement("div",{className:"btn"},o.a.createElement(Z["a"],null,o.a.createElement(R["a"],{type:"animate",target:n._id,addon:"\u7b2c".concat(Object(w["a"])(Number.parseInt(n.season.season)+1),"\u5b63\u7b2c").concat(Object(w["a"])(Number.parseInt(n.season.eposide)+1),"\u96c6")},o.a.createElement(m["a"],{type:"primary",shape:"round"},Object(v["formatMessage"])({id:"report.question"})))))),o.a.createElement(S["a"],{type:"animate",belong:n.slug,target:t})),o.a.createElement("div",{className:"info"},o.a.createElement(s["a"],{bordered:!1,className:"info-main"},o.a.createElement("div",{className:"cover",style:{backgroundImage:"url(".concat(n.cover.vertical,")")},onClick:()=>{C.a.push("/animate/".concat(n.slug))}}),o.a.createElement("div",{className:"title"},n.title),o.a.createElement("div",{className:"introduce"},n.information.introduce)))))},U=J,W=a("Y8ry"),X=e=>{var n,a,t,r=e.split("S");if(2===r.length){n=r[0];var i=r[1].split("E");2===i.length&&(a=Object(w["a"])(parseInt(i[0])-1),t=Object(w["a"])(parseInt(i[1])-1))}return{slug:n,season:a,eposide:t}},G=class extends l["Component"]{constructor(e){super(e),this.initData=(()=>{var e=this.state.data,n=this.props.dispatch,a=X(e),t=a.slug,i=a.season,l=a.eposide;null!==e&&null!==t&&null!==i&&null!==l?n({type:"animate/getPlayInfo",payload:{data:{slug:t,season:i,eposide:l}}}):r["a"].error(Object(v["formatMessage"])({id:"error.data.few"}))}),this.state={data:e.match.params.data}}static getDerivedStateFromProps(e,n){return e.match.params.data!==n.data?{data:e.match.params.data}:null}componentDidMount(){this.initData()}componentDidUpdate(e,n){n.data!==this.state.data&&this.initData()}render(){var e=this.props,n=e.animate.play,a=e.loading;return o.a.createElement(o.a.Fragment,null,a?o.a.createElement(W["a"],null):n.slug?o.a.createElement(U,{play:n}):o.a.createElement(t["a"],{description:o.a.createElement("span",null,Object(v["formatMessage"])({id:"common.empty.tips"})),style:{transform:"translateY(calc(40vh - 50%))"}}))}};G=i["a"]([Object(c["connect"])(e=>{var n=e.animate,a=e.loading;return{animate:n,loading:a.effects["animate/getPlayInfo"]}})],G);n["default"]=G}}]);
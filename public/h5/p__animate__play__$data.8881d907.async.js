(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"8S6H":function(e,t,n){"use strict";n.r(t);n("R9oj");var a=n("ECub"),r=(n("miYZ"),n("tsqr")),l=n("mrSG"),i=n("q1tI"),o=n.n(i),c=n("MuoO"),s=n("qIgq"),m=n.n(s),p=n("fFZ8"),d=n.n(p),u=(n("Znn+"),n("ZTPi")),g=n("vOnD"),h=n("XEok"),b=n("LLXN"),f=n("yDSA"),E=(n("T2oS"),n("W9HT")),v=n("Dp36"),y=n("wd/R"),x=n.n(y),j=n("bdvc");function w(){var e=d()(["\n  margin: -10px 0 10px 0;\n\n  .head {\n    height: 30px;\n    line-height: 30px;\n    display: grid;\n    grid-template-columns: 50px 1fr 60px;\n    font-size: 0.9em;\n    opacity: 0.6;\n    font-weight: 700;\n  }\n\n  .main {\n    .list {\n      line-height: 24px;\n      display: grid;\n      grid-template-columns: 50px 1fr 60px;\n      font-size: 0.8em;\n      opacity: 0.6;\n      cursor: pointer;\n\n      span:nth-child(2) {\n        font-weight: 500;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: pre;\n        word-break: keep-all;\n      }\n\n      span:nth-child(3) {\n        text-align: center;\n      }\n\n      &:hover {\n        color: ",";\n      }\n    }\n  }\n"]);return w=function(){return e},e}var O=e=>{var t=Math.floor(e/60),n=Math.floor(e%60);return"".concat(Object(j["a"])(t),":").concat(Object(j["a"])(n))},k=g["a"].div(w(),e=>e.color),N=e=>{var t=e.id,n=Object(i["useContext"])(h["a"]),a=Object(i["useMemo"])(()=>n,[n]),r=Object(i["useState"])([]),l=m()(r,2),c=l[0],s=l[1],p=Object(i["useState"])(!0),d=m()(p,2),u=d[0],g=d[1];return Object(i["useEffect"])(()=>{v["a"].queryDanmu({query:{id:t}}).then(e=>{s(e.data),g(!1)})},[e.id]),o.a.createElement(k,{color:a},o.a.createElement("div",{className:"head"},o.a.createElement("span",null,Object(b["formatMessage"])({id:"danmu.time"})),o.a.createElement("span",null,Object(b["formatMessage"])({id:"danmu.content"})),o.a.createElement("span",null,Object(b["formatMessage"])({id:"danmu.created"}))),o.a.createElement(E["a"],{spinning:u},o.a.createElement("div",{className:"main"},c.map(e=>o.a.createElement("div",{className:"list"},o.a.createElement("span",null,O(e.time)),o.a.createElement("span",null,e.text),o.a.createElement("span",null,x()(e.createdAt).format("MM-DD")))))))},M=N,D=n("8KYf"),I=n("mNhR"),S=n("3a4m"),q=n.n(S),z=n("eNRF"),C=(n("Quhn"),n("NUga")),F=n.n(C),P=n("ulZh"),R=n.n(P),Z=e=>{var t=e.target,n=e.info,a=e.type,r=Object(i["useContext"])(h["a"]),l=Object(i["useMemo"])(()=>r,[r]);window.Hls=R.a;var c=e=>{var t=e.color,n=e.id,a=e.link,r=e.type,l=window.config.dplayer||"http://api.btstu.cn/sjbz/?lx=dongman",i={container:document.getElementById("dplayer"),autoplay:!0,theme:t,screenshot:!1,hotkey:!0,preload:"auto",volume:.7,mutex:!0,video:{url:a,pic:l,type:"mp4"===r?"auto":"hls"},danmaku:{id:n,api:"/api/v1/danmu/list/",maximum:1e3,bottom:"15%",unlimited:!0}};new F.a(i)};return Object(i["useEffect"])(()=>{"php"!==a&&c({color:l,id:t,link:n.link,type:a})},[e.target]),o.a.createElement(o.a.Fragment,null,"php"===a?o.a.createElement("iframe",{style:{width:"100%",height:"100%",border:"none"},src:n.link}):o.a.createElement("div",{id:"dplayer"}))},T=Z,Y=n("l61h");function A(){var e=d()(["\n  .player {\n    margin-top: 40px;\n    z-index: 999;\n    background-color: rgba(0, 0, 0, 0.1);\n  }\n\n  .eposide {\n    border-top: solid 6px #ebebeb;\n  }\n\n  .info {\n    border-top: solid 6px #ebebeb;\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    padding: 15px;\n\n    .cover {\n      width: 90px;\n      height: 120px;\n      border-radius: 5px;\n      background-color: rgba(0, 0, 0, 0.05);\n      box-shadow: 0 3px 14px 0 hsla(22, 4%, 52%, 0.4);\n      background-size: cover;\n      background-position: center;\n      cursor: pointer;\n    }\n\n    .main {\n      width: calc(100% - 105px);\n      height: 120px;\n      display: flex;\n      flex-direction: column;\n      justify-content: space-between;\n      align-items: flex-start;\n\n      .title {\n        height: 30px;\n        line-height: 30px;\n        font-weight: bold;\n        width: 100%;\n        text-overflow: ellipsis;\n        overflow: hidden;\n        white-space: keep-all;\n      }\n      .count {\n        display: flex;\n        justify-content: flex-start;\n        align-items: center;\n        height: 1.5rem;\n\n        span {\n          margin-right: 20px;\n          i {\n            margin-right: 5px;\n          }\n        }\n      }\n      .introduce {\n        color: #515a6e;\n        height: 4rem;\n        font-size: 12px;\n        line-height: 1rem;\n        overflow: hidden;\n      }\n    }\n  }\n\n  .comment {\n    border-top: solid 6px #ebebeb;\n    padding: 0 15px;\n  }\n"]);return A=function(){return e},e}var H=u["a"].TabPane,_=g["a"].div(A()),J=e=>{var t=e.play,n="".concat(t.slug,"S").concat(t.season.season,"E").concat(t.season.eposide),a="S".concat(t.season.season,"E").concat(t.season.eposide),r=Object(i["useContext"])(h["a"]),l=Object(i["useMemo"])(()=>r,[r]),c=Object(i["useState"])(200),s=m()(c,2),p=s[0],d=s[1],g=Object(i["useRef"])(null);return Object(i["useEffect"])(()=>{d(.5625*g.current.clientWidth)}),o.a.createElement(_,{color:l},o.a.createElement("div",{className:"player",ref:g,style:{height:p}},o.a.createElement(T,{target:n,info:t.playInfo,type:t.play.kind})),o.a.createElement("div",{className:"eposide"},o.a.createElement(f["a"],{slug:t.slug,cover:t.cover.vertical,eposide:t.season})),o.a.createElement("div",{className:"info"},o.a.createElement("div",{className:"cover",style:{backgroundImage:"url(".concat(t.cover.vertical,")")},onClick:()=>{q.a.push("/animate/".concat(t.slug))}}),o.a.createElement("div",{className:"main"},o.a.createElement("div",{className:"title"},t.title),o.a.createElement("div",{className:"count"},o.a.createElement("span",null,o.a.createElement(I["a"],{type:"icon-youtube"}),t.count.play),o.a.createElement("span",null,o.a.createElement(I["a"],{type:"icon-comment1"}),t.count.comment),o.a.createElement("span",null,o.a.createElement(I["a"],{type:"icon-pinglun"}),t.count.danmu),o.a.createElement("span",null,o.a.createElement(Y["a"],null,o.a.createElement(z["a"],{type:"animate",target:t._id,addon:"\u7b2c".concat(Object(j["a"])(Number.parseInt(t.season.season)+1),"\u5b63\u7b2c").concat(Object(j["a"])(Number.parseInt(t.season.eposide)+1),"\u96c6")},o.a.createElement(I["a"],{type:"icon-icon_report_fill"}),Object(b["formatMessage"])({id:"report.question"}))))),o.a.createElement("div",{className:"introduce"},t.information.introduce.slice(0,120)))),o.a.createElement("div",{className:"comment"},o.a.createElement(u["a"],{defaultActiveKey:"1"},o.a.createElement(H,{tab:Object(b["formatMessage"])({id:"animate.play.tabs.danmu"}),key:"1"},o.a.createElement(M,{id:n})),o.a.createElement(H,{tab:"".concat(Object(b["formatMessage"])({id:"animate.tabs.comment"}),"(").concat(t.count.comment,")"),key:"2"},o.a.createElement(D["a"],{type:"animate",belong:t.slug,target:a})))))},K=J,L=n("Y8ry"),U=e=>{var t,n,a,r=e.split("S");if(2===r.length){t=r[0];var l=r[1].split("E");2===l.length&&(n=Object(j["a"])(parseInt(l[0])-1),a=Object(j["a"])(parseInt(l[1])-1))}return{slug:t,season:n,eposide:a}},W=class extends i["Component"]{constructor(e){super(e),this.initData=(()=>{var e=this.state.data,t=this.props.dispatch,n=U(e),a=n.slug,l=n.season,i=n.eposide;null!==e&&null!==a&&null!==l&&null!==i?t({type:"animate/getPlayInfo",payload:{data:{slug:a,season:l,eposide:i}}}):r["a"].error(Object(b["formatMessage"])({id:"error.data.few"}))}),this.state={data:e.match.params.data}}static getDerivedStateFromProps(e,t){return e.match.params.data!==t.data?{data:e.match.params.data}:null}componentDidMount(){this.initData()}componentDidUpdate(e,t){t.data!==this.state.data&&this.initData()}render(){var e=this.props,t=e.animate.play,n=e.loading;return o.a.createElement(o.a.Fragment,null,n?o.a.createElement(L["a"],null):t.slug?o.a.createElement(K,{play:t}):o.a.createElement(a["a"],{description:o.a.createElement("span",null,Object(b["formatMessage"])({id:"common.empty.tips"})),style:{transform:"translateY(calc(40vh - 50%))"}}))}};W=l["a"]([Object(c["connect"])(e=>{var t=e.animate,n=e.loading;return{animate:t,loading:n.effects["animate/getPlayInfo"]}})],W);t["default"]=W}}]);
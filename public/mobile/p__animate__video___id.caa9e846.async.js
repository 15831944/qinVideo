(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"4Mdj":function(e,t,n){"use strict";n.r(t);n("T2oS");var a=n("W9HT"),i=(n("miYZ"),n("tsqr")),r=n("mrSG"),c=n("q1tI"),o=n.n(c),l=n("MuoO"),s=n("qIgq"),m=n.n(s),d=n("fFZ8"),p=n.n(d),u=(n("Znn+"),n("ZTPi")),h=n("vOnD"),g=n("Gwa3"),f=n("LLXN"),b=n("yDSA"),v=n("zz3R"),E=n("wd/R"),x=n.n(E),y=n("xEAY");function w(){var e=p()(["\n  margin: -10px 0 10px 0;\n\n  .head {\n    height: 30px;\n    line-height: 30px;\n    display: grid;\n    grid-template-columns: 50px 1fr 60px;\n    font-size: 0.9em;\n    opacity: 0.6;\n    font-weight: 700;\n  }\n\n  .main {\n    .list {\n      line-height: 24px;\n      display: grid;\n      grid-template-columns: 50px 1fr 60px;\n      font-size: 0.8em;\n      opacity: 0.6;\n      cursor: pointer;\n\n      span:nth-child(2) {\n        font-weight: 500;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: pre;\n        word-break: keep-all;\n      }\n\n      span:nth-child(3) {\n        text-align: center;\n      }\n\n      &:hover {\n        color: ",";\n      }\n    }\n  }\n"]);return w=function(){return e},e}var j=e=>{var t=Math.floor(e/60),n=Math.floor(e%60);return"".concat(Object(y["b"])(t),":").concat(Object(y["b"])(n))},O=h["a"].div(w(),e=>e.color),M=e=>{var t=e.id,n=Object(c["useContext"])(g["a"]),i=Object(c["useMemo"])(()=>n,[n]),r=Object(c["useState"])([]),l=m()(r,2),s=l[0],d=l[1],p=Object(c["useState"])(!0),u=m()(p,2),h=u[0],b=u[1];return Object(c["useEffect"])(()=>{t&&v["a"].queryDanmu({query:{id:t}}).then(e=>{d(e.data.list),b(!1)})},[t]),o.a.createElement(O,{color:i},o.a.createElement("div",{className:"head"},o.a.createElement("span",null,Object(f["formatMessage"])({id:"danmu.time"})),o.a.createElement("span",null,Object(f["formatMessage"])({id:"danmu.content"})),o.a.createElement("span",null,Object(f["formatMessage"])({id:"danmu.created"}))),o.a.createElement(a["a"],{spinning:h},o.a.createElement("div",{className:"main"},s.map(e=>o.a.createElement("div",{className:"list"},o.a.createElement("span",null,j(e.time)),o.a.createElement("span",null,e.text),o.a.createElement("span",null,x()(e.createdAt).format("MM-DD")))))))},N=M,k=n("DNCa"),D=n("YO1i"),q=n("3a4m"),z=n.n(q),C=n("qHAN"),I=n("xK/y"),S=n.n(I),P=n("ulZh"),A=n.n(P),_=e=>{var t=e.info,n=t.id,a=t.link,i=t.danmu,r=t.type,l=t.preview,s=t.subtitle,m=Object(c["useContext"])(g["a"]),d=Object(c["useMemo"])(()=>m,[m]);window.Hls=A.a;var p=()=>{var e,t=window.config.usePicInterface?window.config.picInterface:window.config.dplayer;if(a&&a.length>1){var c=a.map(e=>({name:e.name,url:e.value,type:"auto"}));e={quality:c,defaultQuality:0,pic:t}}else{var o=a&&a[0]&&a[0].value||"";e={url:o,pic:t,type:"m3u8"===r?"hls":"auto"}}l&&l.length>0&&(e.thumbnails=l[0]);var m={container:document.getElementById("dplayer"),autoplay:!0,theme:d,screenshot:!1,hotkey:!0,preload:"auto",volume:.7,mutex:!0,video:e,danmaku:{id:n,api:"/api/v2/danmus",maximum:1e4,bottom:"15%",unlimited:!0,addition:i?["https://api.prprpr.me/dplayer/v3/bilibili?aid=".concat(i)]:[]}};s&&s.length>0&&(m.subtitle={url:s[0].value,type:"webvtt"}),l&&new S.a(m)};return Object(c["useEffect"])(()=>{"php"!==r&&a&&p()},[n]),o.a.createElement(o.a.Fragment,null,"php"===r?o.a.createElement("iframe",{style:{width:"100%",height:"100%",border:"none"},src:a}):o.a.createElement("div",{id:"dplayer"}))},Z=_,T=n("qki9");function F(){var e=p()(["\n  .player {\n    margin-top: 40px;\n    z-index: 999;\n    background-color: rgba(0, 0, 0, 0.1);\n  }\n\n  .eposide {\n    border-top: solid 6px #ebebeb;\n  }\n\n  .info {\n    border-top: solid 6px #ebebeb;\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    padding: 15px;\n\n    .cover {\n      width: 90px;\n      height: 120px;\n      border-radius: 5px;\n      background-color: rgba(0, 0, 0, 0.05);\n      box-shadow: 0 3px 14px 0 hsla(22, 4%, 52%, 0.4);\n      background-size: cover;\n      background-position: center;\n      cursor: pointer;\n    }\n\n    .main {\n      width: calc(100% - 105px);\n      height: 120px;\n      display: flex;\n      flex-direction: column;\n      justify-content: space-between;\n      align-items: flex-start;\n\n      .title {\n        height: 30px;\n        line-height: 30px;\n        font-weight: bold;\n        width: 100%;\n        text-overflow: ellipsis;\n        overflow: hidden;\n        white-space: keep-all;\n      }\n      .count {\n        display: flex;\n        justify-content: flex-start;\n        align-items: center;\n        height: 1.5rem;\n\n        span.icon {\n          margin-right: 20px;\n          i {\n            margin-right: 5px;\n          }\n        }\n      }\n      .introduce {\n        color: #515a6e;\n        height: 4rem;\n        font-size: 12px;\n        line-height: 1rem;\n        overflow: hidden;\n      }\n    }\n  }\n\n  .comment {\n    border-top: solid 6px #ebebeb;\n    padding: 0 15px;\n  }\n"]);return F=function(){return e},e}var H=u["a"].TabPane,R=h["a"].div(F()),Y=e=>{var t=e.info,n=Object(c["useContext"])(g["a"]),a=Object(c["useMemo"])(()=>n,[n]),i=Object(c["useState"])(200),r=m()(i,2),l=r[0],s=r[1],d=Object(c["useRef"])(null);return Object(c["useEffect"])(()=>{s(.5625*d.current.clientWidth)}),o.a.createElement(R,{color:a},o.a.createElement("div",{className:"player",ref:d,style:{height:l}},o.a.createElement(Z,{info:t})),o.a.createElement("div",{className:"eposide"},o.a.createElement(b["a"],{cover:t.target&&t.target.coverVertical,eposide:t.eposides,target:t._id})),o.a.createElement("div",{className:"info"},o.a.createElement("div",{className:"cover",style:{backgroundImage:"url(".concat(t.target&&t.target.coverVertical,")")},onClick:()=>{z.a.push("/animate/".concat(t.target&&t.target.slug))}}),o.a.createElement("div",{className:"main"},o.a.createElement("div",{className:"title"},t.title),o.a.createElement("div",{className:"count"},o.a.createElement("span",{className:"icon"},o.a.createElement(D["a"],{type:"icon-youtube"}),t.countPlay),o.a.createElement("span",{className:"icon"},o.a.createElement(D["a"],{type:"icon-comment1"}),t.countComment),o.a.createElement("span",{className:"icon"},o.a.createElement(D["a"],{type:"icon-pinglun"}),t.countDanmu),o.a.createElement("span",{className:"icon"},o.a.createElement(T["a"],null,o.a.createElement(C["a"],{type:"Animate",target:t._id,onModel:"Eposide"},o.a.createElement(D["a"],{type:"icon-icon_report_fill"}),Object(f["formatMessage"])({id:"report.question"}))))),o.a.createElement("div",{className:"introduce"},t.target&&t.target.introduce&&t.target.introduce.slice(0,120)))),o.a.createElement("div",{className:"comment"},o.a.createElement(u["a"],{defaultActiveKey:"1"},o.a.createElement(H,{tab:Object(f["formatMessage"])({id:"animate.play.tabs.danmu"}),key:"1"},o.a.createElement(N,{id:t._id})),o.a.createElement(H,{tab:"".concat(Object(f["formatMessage"])({id:"animate.tabs.comment"}),"(").concat(t.countComment||0,")"),key:"2"},o.a.createElement(k["a"],{target:t._id,onModel:"Eposide",mobile:!0})))))},G=Y,J=class extends c["Component"]{constructor(e){super(e),this.initData=(()=>{var e=this.state.id,t=this.props.dispatch;null!==e?t({type:"animate/getPlayInfo",payload:{params:{id:e}}}).then(e=>{e&&e.data&&this.setState({info:e.data})}):i["a"].error(Object(f["formatMessage"])({id:"error.data.few"}))}),this.state={id:e.match.params.id,info:{link:[]}}}static getDerivedStateFromProps(e,t){return e.match.params.id!==t.id?{id:e.match.params.id}:null}componentDidMount(){this.initData()}componentDidUpdate(e,t){t.id!==this.state.id&&this.initData()}render(){var e=this.props.loading,t=this.state.info;return o.a.createElement(a["a"],{spinning:e,size:"large"},o.a.createElement(G,{info:t}))}};J=Object(r["a"])([Object(l["connect"])(e=>{var t=e.animate,n=e.loading;return{animate:t,loading:n.effects["animate/getPlayInfo"]}})],J);t["default"]=J}}]);